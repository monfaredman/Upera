(window.webpackJsonp=window.webpackJsonp||[]).push([[140],{1038:function(t,e,n){"use strict";n(924)},1099:function(t,e,n){"use strict";n.r(e);n(40);var r=n(3),o=n(23),c=(n(59),n(17),n(13),n(21),n(22),n(18),n(11),n(29),n(166),n(16),n(91),n(35));function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach(function(e){Object(r.a)(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var h={components:{FilterContents:n(243).default},asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark(function e(){var n,r,o,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.params.search){e.next=3;break}return n={query:t.params.search},t.query.dubbed&&(n.dubbed=1),t.query.subtitle&&(n.subtitle=1),t.query.imdb&&(n.imdb=1),t.query.kids&&(n.kids=1),e.next=1,t.app.$axios.post("/ghost/get/search"+t.store.getters.filtercontents,n);case 1:return r=e.sent,o=null==r.data.data.data&&null==r.data.data.cast,e.next=2,t.app.$axios.get("/ghost/topsearch");case 2:return c=e.sent,"fa"!==t.app.i18n.locale&&(c.data.data.topsearch=c.data.data.topsearch_en),e.abrupt("return",{data:r.data.data,topsearch:c.data.data.topsearch,noresult:o});case 3:return e.next=4,t.app.$axios.get("/ghost/topsearch");case 4:return l=e.sent,"fa"!==t.app.i18n.locale&&(l.data.data.topsearch=l.data.data.topsearch_en),e.abrupt("return",{data:{data:null,cast:null},topsearch:l.data.data.topsearch});case 5:case"end":return e.stop()}},e)}))()},data:function(){return{query:null,dubbed:0,subtitle:0,imdb:0,kids:0,showCast:null,data:{},topsearch:{},noresult:!1,isLoading:!1,suggestions:[],showAutocomplete:!1,autocompleteTimer:null,autocompleteLoading:!1,autocompleteLimit:8,selectedSuggestion:-1}},head:function(){return{title:this.$route.params.search?this.$route.params.search+" | جستجو":"جستجو"}},computed:d(d({},Object(c.c)({lastsearchs:"search/lastsearchs"})),{},{filtercontents:function(){return this.$store.getters.filtercontents}}),mounted:function(){var t=this;this.$store.dispatch("search/GetLastSearchs",this.$route.params.search),this.$route.params.search&&(this.query=this.$route.params.search,this.dubbed=this.$route.query.dubbed,this.subtitle=this.$route.query.subtitle,this.imdb=this.$route.query.imdb,this.kids=this.$route.query.kids,this.$store.dispatch("search/addSearch",this.$route.params.search)),this.$nextTick(function(){t.$refs.searchInput&&t.$refs.searchInput.focus()})},methods:{ChooseLang:function(t,e){return e&&"fa"===this.$i18n.locale?e:t},onInput:function(){var t=this;this.autocompleteTimer&&clearTimeout(this.autocompleteTimer),this.query&&this.query.length>1?this.autocompleteTimer=setTimeout(function(){t.fetchAutocomplete()},300):(this.suggestions=[],this.showAutocomplete=!1,this.selectedSuggestion=-1)},fetchAutocomplete:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark(function e(){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.autocompleteLoading=!0,e.prev=1,e.next=2,t.$axios.post("/ghost/get/search/autocomplete",null,{params:{q:t.query,limit:t.autocompleteLimit},headers:{Accept:"application/json","Content-Type":"application/json"}});case 2:n=e.sent,r=n&&n.data?n.data.data||n.data:[],t.suggestions=r||[],t.showAutocomplete=t.suggestions.length>0,t.selectedSuggestion=-1,e.next=4;break;case 3:e.prev=3,o=e.catch(1),console.error("Autocomplete error:",o),t.suggestions=[],t.showAutocomplete=!1;case 4:return e.prev=4,t.autocompleteLoading=!1,e.finish(4);case 5:case"end":return e.stop()}},e,null,[[1,3,4,5]])}))()},moveSelection:function(t){if(this.showAutocomplete&&0!==this.suggestions.length){var e=this.suggestions.length-1,n=this.selectedSuggestion+t;n<0&&(n=0),n>e&&(n=e),this.selectedSuggestion=n}},handleEnter:function(){if(this.showAutocomplete&&this.selectedSuggestion>=0){var t=this.suggestions[this.selectedSuggestion];t&&this.selectSuggestion(t)}else this.IN_SEARCH()},selectSuggestion:function(t){var title=this.ChooseLang(t.title_en||t.title,t.title_fa);this.query=title,this.showAutocomplete=!1,this.suggestions=[],this.selectedSuggestion=-1,this.IN_SEARCH()},onBlur:function(){var t=this;setTimeout(function(){t.showAutocomplete=!1},150)},onFocus:function(){this.suggestions&&this.suggestions.length>0&&this.query&&this.query.length>1&&(this.showAutocomplete=!0)},SEARCH:function(){if(this.query&&this.query.length>1){var t={};this.dubbed&&(t.dubbed=1),this.subtitle&&(t.subtitle=1),this.imdb&&(t.imdb=1),this.kids&&(t.kids=1),this.$router.push({name:"search-search",params:{search:this.query},query:t})}},removeSearch:function(t){this.$store.dispatch("search/removeSearch",t)},IN_SEARCH:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark(function e(){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.query&&t.query.length>1)){e.next=5;break}return t.isLoading=!0,n={query:t.query},t.dubbed&&(n.dubbed=1),t.subtitle&&(n.subtitle=1),t.imdb&&(n.imdb=1),t.kids&&(n.kids=1),e.prev=1,e.next=2,t.$axios.post("/ghost/get/search"+t.filtercontents,n);case 2:200===(r=e.sent).status&&(t.data=r.data.data,null==r.data.data.data&&null==r.data.data.cast?t.noresult=!0:(t.$store.dispatch("search/addSearch",t.query),t.noresult=!1)),e.next=4;break;case 3:e.prev=3,o=e.catch(1),t.data={data:null,cast:null},t.noresult=!0,console.error("Search error:",o);case 4:return e.prev=4,t.isLoading=!1,e.finish(4);case 5:case"end":return e.stop()}},e,null,[[1,3,4,5]])}))()},execute_content_filtering:function(){var t=this;if(this.$nuxt.$loading.start(),this.$store.dispatch("filter/FILTER_LOADING"),this.query&&this.query.length>1){var e={query:this.query};this.imdb&&(e.imdb=1);this.$axios.post("/ghost/get/search"+this.filtercontents,e).then(function(e){200===e.status&&(t.data=e.data.data,null==e.data.data.data&&null==e.data.data.cast?t.noresult=!0:(t.$store.dispatch("search/addSearch",t.query),t.noresult=!1)),t.$store.dispatch("filter/CLEAN_FILTER_LOADING"),t.$nuxt.$loading.finish()}).catch(function(e){t.$store.dispatch("filter/CLEAN_FILTER_LOADING"),t.$nuxt.$loading.finish(),t.data={data:null,cast:null},t.noresult=!0,console.error("Filter search error:",e)})}}}},m=(n(1038),n(28)),component=Object(m.a)(h,function(){var t=this,e=t._self._c;return e("div",{staticClass:"search-page-container"},[e("div",{staticClass:"search-page-header"},[e("div",{staticClass:"search-input-container"},[e("b-form-input",{ref:"searchInput",staticClass:"search-input",attrs:{autofocus:"",placeholder:t.$t("new.search"),type:"text"},on:{input:t.onInput,keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:(e.preventDefault(),t.moveSelection(1))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:(e.preventDefault(),t.moveSelection(-1))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.handleEnter.apply(null,arguments))}],focus:t.onFocus,blur:t.onBlur},model:{value:t.query,callback:function(e){t.query=e},expression:"query"}}),t._v(" "),e("button",{staticClass:"btn btn-search",on:{click:t.IN_SEARCH}},[e("i",{staticClass:"icon-search"})]),t._v(" "),t.showAutocomplete?e("div",{staticClass:"autocomplete-dropdown"},[t.autocompleteLoading?e("div",{staticClass:"autocomplete-item loading"},[t._v("\n          ...\n        ")]):t._e(),t._v(" "),t._l(t.suggestions,function(n,r){return e("div",{key:n.id+"-"+r,class:["autocomplete-item",{active:r===t.selectedSuggestion}],on:{mousedown:function(e){return e.preventDefault(),t.selectSuggestion(n)}}},[e("div",{staticClass:"autocomplete-title"},[t._v("\n            "+t._s(t.ChooseLang(n.title_en||n.title,n.title_fa))+"\n          ")]),t._v(" "),n.type?e("div",{staticClass:"autocomplete-meta"},[t._v("\n            "+t._s(n.type)+"\n          ")]):t._e()])}),t._v(" "),t.autocompleteLoading||0!==t.suggestions.length?t._e():e("div",{staticClass:"autocomplete-item empty"},[t._v("\n          هیچ موردی یافت نشد\n        ")])],2):t._e()],1)]),t._v(" "),e("div",{staticClass:"search-page-content"},[e("FilterContents",{attrs:{show:!0,savedata:!1,"no-top":!1,"is-search":!0},on:{execute_content_filtering:t.execute_content_filtering}}),t._v(" "),e("div",{staticClass:"search-main-content"},[e("div",{staticClass:"search_badge"},[e("a",{staticClass:"badge badge-pill small font-weight-normal py-2 px-3 mt-2 mb-2",class:{"badge-secondary":!t.imdb,"badge-info":t.imdb},attrs:{href:""},on:{click:function(e){e.preventDefault(),t.imdb=!t.imdb,t.IN_SEARCH()}}},[t._v("امتیاز +۸")])]),t._v(" "),!t.query&&t.lastsearchs&&null==t.data.data&&null==t.data.cast?e("div",{staticClass:"search-tags",attrs:{id:"search-tags"}},t._l(t.lastsearchs,function(n,r){return e("div",{key:r,staticClass:"tag mt-2"},[e("i",{staticClass:"icon-close",on:{click:function(e){return t.removeSearch(n)}}}),t._v(" "),e("span",{on:{click:function(e){t.query=n,t.IN_SEARCH()}}},[t._v(t._s(n))])])}),0):t._e(),t._v(" "),!t.query&&t.topsearch&&null==t.data.data&&null==t.data.cast?e("header",{staticClass:"headline py-4"},[e("h6",{staticClass:"title"},[t._v("محبوبترین جستجوها")])]):t._e(),t._v(" "),!t.query&&t.topsearch&&null==t.data.data&&null==t.data.cast?e("div",{staticClass:"d-flex flex-column align-start popular_search",attrs:{id:"popular_search"}},t._l(t.topsearch,function(n,r){return e("a",{key:r,staticClass:"clearfix",class:{"pt-4":r>0},attrs:{href:""},on:{click:function(e){e.preventDefault(),t.query=n,t.IN_SEARCH()}}},[t._v(t._s(n))])}),0):t._e(),t._v(" "),t.noresult&&t.query?e("div",{staticClass:"movie_notFound",attrs:{id:"notFound"}},[e("p",[t._v("\n          متاسفانه چیزی پیدا نکردیم. میتوانید به قسمت\n          "),e("nuxt-link",{attrs:{to:"/genres"}},[e("span",[t._v("دسته بندی")])]),t._v("\n          سری بزنین یا\n          "),e("nuxt-link",{attrs:{to:"/genres"}},[e("span",[t._v("درخواست اضافه کردن فیلم یا سریال")])]),t._v("\n          مورد نظرتون رو بدین.\n        ")],1)]):t._e(),t._v(" "),t.isLoading?e("div",{staticClass:"search_skeleton mt-5 container-fluid"},t._l(10,function(n){return e("div",{key:n,staticClass:"actor"},[e("b-skeleton-img",{staticClass:"mb-2 rounded",attrs:{"no-aspect":"",width:"142px",height:"212px",animation:"wave"}}),t._v(" "),e("b-skeleton",{attrs:{width:"70%",animation:"wave"}})],1)}),0):null!=t.data.data||null!=t.data.cast?e("div",{staticClass:"search_collection",attrs:{id:"actor"}},[e("div",{staticClass:"mt-5"},[null!=t.data.data?e("div",{staticClass:"container-fluid"},t._l(t.data.data,function(n,r){return e("div",{key:r,staticClass:"mt-2 actor"},[e("nuxt-link",{staticClass:"link-wrapper",attrs:{to:{name:n.type+"-id",params:{id:n.id}}}},[!n.ir&&n.persian?e("span",{staticClass:"label label-rounded label-red label-1"},[t._v("دوبله")]):t._e(),t._v(" "),n.ir||n.persian?t._e():e("span",{staticClass:"label label-rounded label-warning label-1"},[t._v("زیرنویس")]),t._v(" "),n.free&&"upera"==t.$config.envname?e("span",{staticClass:"label label-blue label-2"},[t._v("رایگان")]):t._e(),t._v(" "),e("b-img",t._b({directives:[{name:"lazy-load",rawName:"v-lazy-load"}],attrs:{"data-src":"https://thumb.upera.shop/thumb?w=142&h=212&q=100&a=c&src=https://cdn.upera.shop/s3/posters/"+n.poster,alt:n.name}},"b-img",{fluidGrow:!0,blank:!0,blankColor:"#bbb",width:142,height:212,show:!0},!1))],1),t._v(" "),e("h6",{staticClass:"mt-2 small font-weight-normal"},[t._v("\n                "+t._s(t.ChooseLang(n.name,n.name_fa))+"\n              ")])],1)}),0):t._e(),t._v(" "),null!=t.data.cast?e("div",{staticClass:"container-fluid mt-4"},t._l(t.data.cast,function(n,r){return e("div",{key:r,staticClass:"actor2"},[e("nuxt-link",{attrs:{to:{name:"cast-id",params:{id:n.id}}}},[e("b-img",t._b({directives:[{name:"lazy-load",rawName:"v-lazy-load"}],staticClass:"rounded-circle",attrs:{"data-src":"https://thumb.upera.shop/thumb?w=140&h=140&q=100&a=t&src=https://cdn.upera.shop/s3/casts/"+n.image,alt:n.name}},"b-img",{fluidGrow:!0,blank:!0,blankColor:"#bbb",width:140,height:140,show:!0},!1)),t._v(" "),e("span",{staticClass:"block",class:"dark"===t.$colorMode.value?"text-white":"text-dark"},[t._v(t._s(t.ChooseLang(n.name,n.name_fa)))])],1)],1)}),0):t._e()])]):t._e()])],1)])},[],!1,null,"7c790731",null);e.default=component.exports;installComponents(component,{FilterContents:n(243).default,Header:n(117).default})},924:function(t,e,n){t.exports={}}}]);