(window.webpackJsonp=window.webpackJsonp||[]).push([[142],{1002:function(t,e,o){var content=o(1103);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(57).default)("05713846",content,!0,{sourceMap:!1})},1102:function(t,e,o){"use strict";o(1002)},1103:function(t,e,o){var r=o(56)(function(i){return i[1]});r.push([t.i,".site-logo img[data-v-2b9d1007]{opacity:.3!important}[data-v-2b9d1007] .full-screen-player.vjs-fluid{overflow:hidden!important}.video-player-page[data-v-2b9d1007]{height:100%;position:relative;width:100%}.modal-container[data-v-2b9d1007]{background:#fff;border-radius:8px;max-width:600px;padding:1rem;width:90%}.header[data-v-2b9d1007]{text-align:right}.sm-exit-svg[data-v-2b9d1007]{cursor:pointer;width:24px}.video-overlay[data-v-2b9d1007]{display:flex;justify-content:space-between;left:10px;position:absolute;right:10px;top:10px;z-index:500}.back-button[data-v-2b9d1007]{background:rgba(0,0,0,.6);border:none;border-radius:4px;color:#fff;cursor:pointer;padding:8px}.back-button[data-v-2b9d1007]:hover{background:rgba(0,0,0,.8)}.next-video-overlay[data-v-2b9d1007]{background:rgba(0,0,0,.7);border-radius:8px;bottom:60px;cursor:pointer;padding:10px;position:absolute;right:20px;z-index:600}.next-video-content p[data-v-2b9d1007]{color:#fff;margin:0 0 5px}.next-video-content img[data-v-2b9d1007]{border-radius:4px;width:100%}.player-wrapper[data-v-2b9d1007]{height:100%}.video-loading-spinner[data-v-2b9d1007]{left:50%;position:absolute;top:50%;transform:translate(-50%,-50%)}",""]),r.locals={},t.exports=r},1171:function(t,e,o){"use strict";o.r(e);var r=o(23),n=(o(60),o(34),o(69),o(44),o(40),o(11),o(96),{components:{VideoPlayer:o(764).default},beforeRouteLeave:function(t,e,o){if(this.$swal&&this.$swal.close)try{this.$swal.close()}catch(t){}o()},layout:"empty",data:function(){return{videoTitle:"",posterUrl:"",videoUrl:"",creditsData:{},tracks:[],loading:!0,guest:!0,soon:!1,recentlyTime:200,showNextVideo:!1,suggestion:null,suggestionBackdrop:"",startTime:0,fullrateData:null}},mounted:function(){this.$auth&&this.$auth.loggedIn&&(this.guest=!1),this.loadVideo(),window.addEventListener("popstate",this.handlePopState)},beforeDestroy:function(){if(this.$swal&&this.$swal.close)try{this.$swal.close()}catch(t){}window.removeEventListener("popstate",this.handlePopState)},methods:{handlePopState:function(){if(this.$swal&&this.$swal.close)try{this.$swal.close()}catch(t){}},showErrorAlert:function(data){var t=this,e="fa"===this.$i18n.locale?data.message_fa:data.message;e||(e=this.$t("player.error1"));var o={back:{text:this.$t("player.back"),value:"back",closeModal:!0,className:"swal-back"}};1===data.show_subscription&&(o.subscribe={text:this.$t("player.subscribe"),value:"subscribe",closeModal:!0}),this.$auth.loggedIn||1!==data.show_login||Object.assign(o,{login:{text:this.$t("nav.login"),value:"login",closeModal:!0}}),this.$swal({title:e,icon:"error",dangerMode:!0,buttons:o}).then(function(e){switch(e){case"back":default:window.history.length>2?t.$router.go(-1):t.$router.push({name:"video-id",params:{id:t.$route.params.id}});break;case"subscribe":t.$store.dispatch("subscription/SHOW_MODAL",{content_type:"video",content_id:t.$route.params.id});break;case"login":t.$store.dispatch("login/SHOW_MODAL",{premessage:null,premobile:null,preredirect:null,prerefresh:!1})}})},loadVideo:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark(function e(){var o,r,n,d,data,l,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,o=t.$route.params.id){e.next=1;break}return e.abrupt("return");case 1:return r=t.$cookiz.get("ref")||"",n=t.guest?"/ghost/get/watch/video/".concat(o).concat(r?"?ref=".concat(r):""):"/get/watch/video/".concat(o).concat(r?"?ref=".concat(r):""),e.next=2,t.$axios.get(n);case 2:if(200!==(d=e.sent).status){e.next=4;break}return(data=d.data.data).fullrate_data&&(t.fullrateData=data.fullrate_data),t.creditsData={first_credits:data.first_credits||null,after_credits:data.after_credits||null,final_credits:data.final_credits||null},t.videoTitle="fa"===t.$i18n.locale&&data.video[0].name_fa?data.video[0].name_fa:data.video[0].name,t.posterUrl=data.cdn.lg_backdrop+data.video[0].backdrop,l=data.video[0].video.includes("?")?data.video[0].video+"&nosub=1":data.video[0].video+"?nosub=1",t.startTime=data.video[0].current_time||0,e.next=3,fetch(l,{method:"HEAD"});case 3:e.sent.ok?(t.videoUrl=l,t.soon=!1):t.soon=!0,data.new_subtitle&&Array.isArray(data.new_subtitle)&&(t.tracks=data.new_subtitle.map(function(track,t){return{kind:"captions",label:track.language,src:track.url,default:0===t}})),data.suggestion&&(t.suggestion=data.suggestion,t.suggestionBackdrop=data.cdn.md_backdrop+data.suggestion.backdrop),e.next=5;break;case 4:t.showErrorAlert(d.data.data);case 5:e.next=7;break;case 6:e.prev=6,c=e.catch(0),t.showErrorAlert(c.response.data);case 7:return e.prev=7,t.loading=!1,e.finish(7);case 8:case"end":return e.stop()}},e,null,[[0,6,7,8]])}))()},handlePlayerReady:function(t){this.startTime&&t.currentTime&&t.currentTime(this.startTime)},handleTimeUpdate:function(t){var e=t.currentTime,o=t.duration,r=t.player;if(Math.floor(e)>=this.recentlyTime){this.recentlyTime=Math.floor(e)+200;var n={current_time:Math.floor(e),duration_time:Math.floor(o),video_id:this.$route.params.id};this.guest?this.$axios.post("/ghost/create/watch/video/recently",n):this.$axios.post("/create/watch/video/recently",n)}return this.creditsData.final_credits&&e>=this.creditsData.final_credits&&this.suggestion||!this.creditsData.final_credits&&o-e<=100&&this.suggestion?this.showNextMovie=!0:this.showNextMovie=!1,r},handleEnded:function(){this.suggestion&&this.playNextVideo()},playNextVideo:function(){this.$router.push({name:"video-show-id",params:{id:this.suggestion.id}})},goBack:function(){window.history.length>2?this.$router.go(-1):this.$router.push({name:"video-id",params:{id:this.$route.params.id}})},handleSubscriptionPurchase:function(){console.log("Subscription purchase triggered from video player")}}}),d=(o(1102),o(28)),component=Object(d.a)(n,function(){var t=this,e=t._self._c;return e("div",{staticClass:"video-container"},[e("div",{staticClass:"hamshahri"},[e("a",{staticClass:"srmjs",on:{click:t.goBack}},[t._m(0)]),t._v(" "),t.loading?e("div",{staticClass:"video-loading-spinner"}):t._e(),t._v(" "),t.soon?e("p",{staticClass:"soon"},[t._v("به زودی...")]):t._e(),t._v(" "),t.soon?e("button",{staticClass:"btn btn-primary btn-lg fw-bold refresh-btn",on:{click:t.reloadPage}},[t._v("\n      بارگذاری مجدد\n    ")]):t._e()]),t._v(" "),e("div",{staticClass:"player-wrapper"},[t.videoUrl&&!t.loading?e("VideoPlayer",{directives:[{name:"lazy-load",rawName:"v-lazy-load"}],ref:"videoPlayer",staticClass:"full-screen-player vjs-fluid",attrs:{playerid:"video-player",stream:t.videoUrl,"data-poster":t.posterUrl,title:t.videoTitle,tracks:t.tracks,"player-auto-play":!0,"credits-data":t.creditsData,"fullrate-data":t.fullrateData,"content-id":t.$route.params.id,"content-type":"video"},on:{ready:t.handlePlayerReady,timeupdate:t.handleTimeUpdate,ended:t.handleEnded,"subscription-purchase":t.handleSubscriptionPurchase}}):t._e()],1),t._v(" "),t.showNextVideo&&t.suggestion?e("div",{staticClass:"next-video-overlay",on:{click:t.playNextVideo}},[e("div",{staticClass:"next-video-content"},[e("p",[t._v(t._s(t.$t("player.next"))+": "+t._s(t.suggestion.name_fa))]),t._v(" "),e("img",{directives:[{name:"lazy-load",rawName:"v-lazy-load"}],attrs:{"data-src":t.suggestionBackdrop,alt:"Next Video Backdrop"}})])]):t._e()])},[function(){var t=this._self._c;return t("div",{attrs:{id:"flowplayer-back-button"}},[t("div",{staticClass:"icon-back"})])}],!1,null,"2b9d1007",null);e.default=component.exports;installComponents(component,{VideoPlayer:o(764).default})}}]);