(window.webpackJsonp=window.webpackJsonp||[]).push([[8,29,30],{769:function(e,t,n){var content=n(817);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(57).default)("17cc2702",content,!0,{sourceMap:!1})},773:function(e,t,n){"use strict";n.r(t);n(137);var r={name:"CommentCard",props:{userImage:{type:String,default:""},userName:{type:String,required:!0},content:{type:String,required:!0},approved:{type:[Boolean,Number],default:!0},votes:{type:Number,default:0},showReplyButton:{type:Boolean,default:!1},timestamp:{type:String,default:""}},computed:{formattedTime:function(){if(!this.timestamp)return"همین الان";var e=new Date(this.timestamp),t=new Date,n=Math.floor((t-e)/1e3);if(n<60)return"همین الان";if(n<3600){var r=Math.floor(n/60);return"".concat(r," دقیقه پیش")}if(n<86400){var o=Math.floor(n/3600);return"".concat(o," ساعت پیش")}if(n<604800){var c=Math.floor(n/86400);return"".concat(c," روز پیش")}if(n<2592e3){var l=Math.floor(n/604800);return"".concat(l," هفته پیش")}if(n<31536e3){var d=Math.floor(n/2592e3);return"".concat(d," ماه پیش")}var m=Math.floor(n/31536e3);return"".concat(m," سال پیش")}}},o=(n(816),n(28)),component=Object(o.a)(r,function(){var e=this,t=e._self._c;return t("div",{staticClass:"comment-card"},[t("div",{staticClass:"comment-avatar"},[e.userImage?t("img",{directives:[{name:"lazy-load",rawName:"v-lazy-load"}],attrs:{"data-src":e.userImage,alt:"User avatar"}}):t("div",{staticClass:"avatar-placeholder"},[t("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[t("path",{attrs:{d:"M12 12C14.21 12 16 10.21 16 8C16 5.79 14.21 4 12 4C9.79 4 8 5.79 8 8C8 10.21 9.79 12 12 12ZM12 14C9.33 14 4 15.34 4 18V20H20V18C20 15.34 14.67 14 12 14Z",fill:"#FFFFFF"}})])])]),e._v(" "),t("div",{staticClass:"comment-content-wrapper"},[t("div",{staticClass:"comment-header"},[t("span",{staticClass:"comment-user-name"},[e._v(e._s(e.userName))]),e._v(" "),t("span",{staticClass:"comment-timestamp"},[e._v(e._s(e.formattedTime))])]),e._v(" "),t("p",{staticClass:"comment-text",class:{"not-approved":!e.approved}},[e._v("\n      "+e._s(e.content)+"\n    ")]),e._v(" "),t("div",{staticClass:"comment-actions"},[t("button",{staticClass:"action-btn upvote-btn",on:{click:function(t){return e.$emit("upvote")}}},[t("i",{staticClass:"fa fa-thumbs-up"})]),e._v(" "),t("span",{staticClass:"votes-count"},[e._v(e._s(e.votes||0))]),e._v(" "),t("button",{staticClass:"action-btn downvote-btn",on:{click:function(t){return e.$emit("downvote")}}},[t("i",{staticClass:"fa fa-thumbs-down"})]),e._v(" "),e.showReplyButton?t("button",{staticClass:"action-btns reply-btn",on:{click:function(t){return e.$emit("reply")}}},[e._v("\n        پاسخ\n      ")]):e._e()]),e._v(" "),e._t("default")],2)])},[],!1,null,"ce9a68fc",null);t.default=component.exports},780:function(e,t,n){var content=n(840);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(57).default)("5b27bc82",content,!0,{sourceMap:!1})},782:function(e,t,n){"use strict";n.r(t);n(40),n(17),n(13),n(21),n(22),n(18),n(11),n(16);var r=n(23),o=n(3),c=(n(60),n(34),n(456),n(83),n(35)),l=n(773);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var m=Object.freeze({AUTH:"/comments-v2",GHOST:"/ghost/comments-v2"}),v=Object.freeze({PAGE:1,LIMIT:10}),f=Object.freeze({UP:"up",DOWN:"down"}),h=Object.freeze({DIRECT:"directcomment",REPLY:"replycomment"}),x={components:{CommentCard:l.default},props:{type:{type:String,default:null},id:{type:String,default:null},name:{type:String,default:null},namefa:{type:String,default:null}},data:function(){return{avatar:null,fullname:null,commentsData:[],message:null,errorComment:null,errorReply:null,loading:!1,hasFetched:!1,fetchCancelToken:null,replyBoxes:{},replyMessage:{},COMMENT_TYPES:h,VOTE_TYPES:f}},computed:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach(function(t){Object(o.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},Object(c.c)({commentsloading:"comments/commentsloading"})),watch:{id:function(e,t){e&&e!==t&&(this.hasFetched=!1,this.fetchComments())},type:function(e,t){e&&e!==t&&(this.hasFetched=!1,this.fetchComments())}},mounted:function(){this.hasFetched||this.fetchComments()},beforeDestroy:function(){this.fetchCancelToken&&(this.fetchCancelToken.cancel("Component destroyed"),this.fetchCancelToken=null)},methods:{ChooseLang:function(e,t){return t&&"fa"===this.$i18n.locale?t:e},ChooseFaType:function(){return"movie"===this.type?"فیلم":"episode"===this.type?"قسمت":"سریال"},getApiUrl:function(){return this.$auth.loggedIn?m.AUTH:m.GHOST},fetchComments:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark(function t(){var n,r,o,c,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.hasFetched&&e.type&&e.id){t.next=1;break}return t.abrupt("return");case 1:return e.fetchCancelToken&&e.fetchCancelToken.cancel("New request initiated"),n=e.$axios.CancelToken,e.fetchCancelToken=n.source(),e.$store.dispatch("comments/COMMENTS_SPINER_LOAD"),t.prev=2,r=v.PAGE,o=v.LIMIT,t.next=3,e.$axios.get(e.getApiUrl(),{params:{type:e.type,id:e.id,page:r,limit:o},cancelToken:e.fetchCancelToken.token});case 3:200===(c=t.sent).status&&"success"===c.data.status?(e.commentsData=c.data.comments.data,e.avatar=c.data.avatar,e.fullname=c.data.name,e.errorComment=null,e.hasFetched=!0):e.errorComment=c.data.message||"خطا در دریافت نظرات",t.next=6;break;case 4:if(t.prev=4,l=t.catch(2),!e.$axios.isCancel(l)){t.next=5;break}return t.abrupt("return");case 5:e.errorComment=l.response&&l.response.data&&l.response.data.message||"خطای شبکه";case 6:return t.prev=6,e.$store.dispatch("comments/COMMENTS_SPINER_CLEAN"),e.fetchCancelToken=null,t.finish(6);case 7:case"end":return t.stop()}},t,null,[[2,4,6,7]])}))()},saveComment:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.message&&""!==e.message.trim()){t.next=1;break}return e.errorComment="لطفا نظر خود را وارد نمایید",t.abrupt("return");case 1:if(e.errorComment=null,e.$auth.loggedIn){t.next=2;break}return e.$store.dispatch("login/SHOW_MODAL",{premessage:null,premobile:null,preredirect:null,prerefresh:!1}),t.abrupt("return");case 2:return e.loading=!0,t.prev=3,t.next=4,e.$axios.post(m.AUTH,{type:e.type,id:e.id,content:e.message,parent_id:null});case 4:200!==(n=t.sent).status&&201!==n.status||"success"!==n.data.status?e.errorComment=n.data.message||"ثبت نظر ناموفق بود":(e.commentsData.unshift(n.data.comment),e.message=null),t.next=6;break;case 5:t.prev=5,r=t.catch(3),e.errorComment=r.response&&r.response.data&&r.response.data.message||"خطای شبکه";case 6:return t.prev=6,e.loading=!1,t.finish(6);case 7:case"end":return t.stop()}},t,null,[[3,5,6,7]])}))()},toggleReplyBox:function(e){var t=!this.replyBoxes[e];this.$set(this.replyBoxes,e,t),this.$set(this.replyMessage,e,"")},sendReply:function(e,t){var n=this;return Object(r.a)(regeneratorRuntime.mark(function r(){var o,c,l;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if((o=n.replyMessage[e])&&""!==o.trim()){r.next=1;break}return n.errorReply="لطفا پاسخ خود را وارد نمایید",r.abrupt("return");case 1:if(n.errorReply=null,n.$auth.loggedIn){r.next=2;break}return n.$store.dispatch("login/SHOW_MODAL",{premessage:null,premobile:null,preredirect:null,prerefresh:!1}),r.abrupt("return");case 2:return n.loading=!0,r.prev=3,r.next=4,n.$axios.post(m.AUTH,{type:n.type,id:n.id,content:o,parent_id:e});case 4:200!==(c=r.sent).status&&201!==c.status||"success"!==c.data.status?n.errorReply=c.data.message||"ثبت پاسخ ناموفق بود":(n.commentsData[t].replies||n.$set(n.commentsData[t],"replies",[]),n.commentsData[t].replies.unshift(c.data.comment),n.$set(n.replyMessage,e,""),n.$set(n.replyBoxes,e,!1)),r.next=6;break;case 5:r.prev=5,l=r.catch(3),n.errorReply=l.response&&l.response.data&&l.response.data.message||"خطای شبکه";case 6:return r.prev=6,n.loading=!1,r.finish(6);case 7:case"end":return r.stop()}},r,null,[[3,5,6,7]])}))()},voteComment:function(e,t,n,o,c){var l=this;return Object(r.a)(regeneratorRuntime.mark(function r(){var d,v,f,x;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(l.$auth.loggedIn){r.next=1;break}return l.$store.dispatch("login/SHOW_MODAL",{premessage:"نیاز به ورود",premobile:null,preredirect:null,prerefresh:!1}),r.abrupt("return");case 1:return l.loading=!0,r.prev=2,r.next=3,l.$axios.post("".concat(m.AUTH,"/").concat(e,"/vote"),{vote:c});case 3:200===(d=r.sent).status&&"success"===d.data.status&&(t===h.DIRECT?l.$set(l.commentsData[n],"votes",d.data.votes):t===h.REPLY&&null!==(v=l.commentsData[n])&&void 0!==v&&null!==(v=v.replies)&&void 0!==v&&v[o]&&l.$set(l.commentsData[n].replies[o],"votes",d.data.votes)),r.next=5;break;case 4:r.prev=4,x=r.catch(2),f=x.response&&x.response.data&&x.response.data.message||"خطای شبکه",t===h.REPLY?l.errorReply=f:l.errorComment=f;case 5:return r.prev=5,l.loading=!1,r.finish(5);case 6:case"end":return r.stop()}},r,null,[[2,4,5,6]])}))()}}},w=x,C=(n(839),n(28)),component=Object(C.a)(w,function(){var e=this,t=e._self._c;return t("div",{staticClass:"comments-container"},[t("div",{staticClass:"comments-count-header"},[e.commentsData&&e.commentsData.length?t("span",[e._v(e._s(e.commentsData.length))]):e._e(),e._v("\n    دیدگاه ثبت شده\n  ")]),e._v(" "),t("div",{staticClass:"comment-input-wrapper"},[e.avatar?t("div",{staticClass:"user-avatar",style:{backgroundImage:"url(".concat(e.avatar,")")}}):t("div",{staticClass:"user-avatar user-avatar-placeholder"},[t("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[t("path",{attrs:{d:"M12 12C14.21 12 16 10.21 16 8C16 5.79 14.21 4 12 4C9.79 4 8 5.79 8 8C8 10.21 9.79 12 12 12ZM12 14C9.33 14 4 15.34 4 18V20H20V18C20 15.34 14.67 14 12 14Z",fill:"#D4D4D4"}})])]),e._v(" "),t("div",{staticClass:"input-box-wrapper"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.message,expression:"message"}],staticClass:"comment-input",attrs:{type:"text",placeholder:"نوشتن نظر"},domProps:{value:e.message},on:{input:function(t){t.target.composing||(e.message=t.target.value)}}}),e._v(" "),t("button",{staticClass:"comment-send-button",on:{click:e.saveComment}},[e._v("\n        ارسال\n        "),t("svg",{attrs:{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[t("path",{attrs:{d:"M2.5 10L17.5 3.33333L10.8333 18.3333L8.33333 11.6667L2.5 10Z",stroke:"white","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}})])])])]),e._v(" "),e.errorComment?t("div",{staticClass:"error-message"},[e._v("\n    "+e._s(e.errorComment)+"\n  ")]):e._e(),e._v(" "),e.commentsData&&e.commentsData.length?t("div",{attrs:{id:"comments"}},e._l(e.commentsData,function(n,r){return t("div",{key:n.id,staticClass:"comment-item"},[t("CommentCard",{attrs:{userImage:n.user.image,userName:n.user.name,content:n.content,approved:n.approved,votes:n.votes||0,showReplyButton:!0,timestamp:n.created_at||n.timestamp},on:{upvote:function(t){return e.voteComment(n.id,e.COMMENT_TYPES.DIRECT,r,null,e.VOTE_TYPES.UP)},downvote:function(t){return e.voteComment(n.id,e.COMMENT_TYPES.DIRECT,r,null,e.VOTE_TYPES.DOWN)},reply:function(t){return e.toggleReplyBox(n.id)}}},[e.replyBoxes[n.id]?t("div",{staticClass:"comment-input-wrapper reply-input-wrapper"},[e.avatar?t("div",{staticClass:"user-avatar",style:{backgroundImage:"url(".concat(e.avatar,")")}}):t("div",{staticClass:"user-avatar user-avatar-placeholder"},[t("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[t("path",{attrs:{d:"M12 12C14.21 12 16 10.21 16 8C16 5.79 14.21 4 12 4C9.79 4 8 5.79 8 8C8 10.21 9.79 12 12 12ZM12 14C9.33 14 4 15.34 4 18V20H20V18C20 15.34 14.67 14 12 14Z",fill:"#D4D4D4"}})])]),e._v(" "),t("div",{staticClass:"input-box-wrapper"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.replyMessage[n.id],expression:"replyMessage[comment.id]"}],staticClass:"comment-input",attrs:{type:"text",placeholder:"نوشتن نظر"},domProps:{value:e.replyMessage[n.id]},on:{input:function(t){t.target.composing||e.$set(e.replyMessage,n.id,t.target.value)}}}),e._v(" "),t("button",{staticClass:"comment-reply-button",on:{click:function(t){return e.sendReply(n.id,r)}}},[e._v("\n              ارسال پاسخ\n\n              "),t("svg",{attrs:{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[t("path",{attrs:{d:"M2.5 10L17.5 3.33333L10.8333 18.3333L8.33333 11.6667L2.5 10Z",stroke:"white","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}})])])])]):e._e(),e._v(" "),n.replies&&n.replies.length?t("div",{staticClass:"replies-container"},e._l(n.replies,function(n,o){return t("CommentCard",{key:n.id,attrs:{userImage:n.user.image,userName:n.user.name,content:n.content,approved:n.approved,votes:n.votes||0,showReplyButton:!1,timestamp:n.created_at||n.timestamp},on:{upvote:function(t){return e.voteComment(n.id,e.COMMENT_TYPES.REPLY,r,o,e.VOTE_TYPES.UP)},downvote:function(t){return e.voteComment(n.id,e.COMMENT_TYPES.REPLY,r,o,e.VOTE_TYPES.DOWN)}}})}),1):e._e()])],1)}),0):e._e()])},[],!1,null,"b1d35174",null);t.default=component.exports;installComponents(component,{CommentCard:n(773).default})},816:function(e,t,n){"use strict";n(769)},817:function(e,t,n){var r=n(56)(function(i){return i[1]});r.push([e.i,".comment-card[data-v-ce9a68fc]{display:flex;gap:10px;margin-bottom:24px}.comment-avatar[data-v-ce9a68fc]{align-items:center;background:#a3a3a3;border-radius:24px;display:flex;flex-shrink:0;height:48px;justify-content:center;opacity:1;overflow:hidden;padding:0;width:48px}.comment-avatar img[data-v-ce9a68fc]{border-radius:50%;height:100%;-o-object-fit:contain;object-fit:contain;width:100%}.avatar-placeholder[data-v-ce9a68fc]{align-items:center;display:flex;height:100%;justify-content:center;width:100%}.comment-content-wrapper[data-v-ce9a68fc]{display:flex;flex:1;flex-direction:column}.comment-header[data-v-ce9a68fc]{align-items:center;display:flex;gap:12px;margin-bottom:8px}.comment-user-name[data-v-ce9a68fc]{font-size:16px;font-weight:600;line-height:28px;text-align:right}.comment-timestamp[data-v-ce9a68fc]{color:#a3a3a3;font-size:13px;font-weight:400;line-height:24px;text-align:right}.comment-text[data-v-ce9a68fc]{font-size:16px;font-weight:500;line-height:28px;text-align:right;word-wrap:break-word}p.comment-text[data-v-ce9a68fc]{margin:0!important}.comment-text.not-approved[data-v-ce9a68fc]{font-style:italic;opacity:.6}.comment-actions[data-v-ce9a68fc]{gap:12px}.action-btn[data-v-ce9a68fc],.comment-actions[data-v-ce9a68fc]{align-items:center;display:flex}.action-btn[data-v-ce9a68fc]{background:transparent;border:none;border-radius:6px;color:#a3a3a3;cursor:pointer;font-size:14px;gap:4px;padding:6px;transition:all .2s ease}.action-btn[data-v-ce9a68fc]:hover{background:hsla(0,0%,100%,.1);color:#fff}.upvote-btn[data-v-ce9a68fc]:hover{color:#4ade80}.downvote-btn[data-v-ce9a68fc]:hover{color:#f87171}.reply-btn[data-v-ce9a68fc]{color:#1b6be5;font-weight:500}.reply-btn[data-v-ce9a68fc]:hover{background:rgba(27,107,229,.1)}.votes-count[data-v-ce9a68fc]{color:#fafafa;font-size:14px;min-width:24px;text-align:center}.action-btns[data-v-ce9a68fc]{align-items:center;background:transparent;border:none;border-radius:6px;color:#a3a3a3;cursor:pointer;display:flex;font-size:14px;gap:4px;padding:6px;transition:all .2s ease}@media (max-width:768px){.comment-avatar[data-v-ce9a68fc]{border-radius:20px;height:40px;width:40px}.comment-user-name[data-v-ce9a68fc]{font-size:14px;line-height:24px}.comment-timestamp[data-v-ce9a68fc]{font-size:12px;line-height:20px}.comment-text[data-v-ce9a68fc]{font-size:14px;line-height:24px}.action-btn[data-v-ce9a68fc]{font-size:12px;padding:4px 8px}}",""]),r.locals={},e.exports=r},839:function(e,t,n){"use strict";n(780)},840:function(e,t,n){var r=n(56)(function(i){return i[1]});r.push([e.i,".comments-container[data-v-b1d35174]{margin:3rem 41px}.comments-count-header[data-v-b1d35174]{font-size:20px;font-weight:600;margin-bottom:24px;opacity:1}.comment-input-wrapper[data-v-b1d35174]{align-items:center;display:flex;gap:10px;margin-bottom:24px}.reply-input-wrapper[data-v-b1d35174]{margin-right:58px;margin-top:16px}.user-avatar[data-v-b1d35174]{background-position:50%;background-repeat:no-repeat;background-size:cover;border-radius:24px;flex-shrink:0;height:48px;opacity:1;padding:8px;width:48px}.user-avatar-placeholder[data-v-b1d35174]{align-items:center;background-color:#555;display:flex;justify-content:center}.input-box-wrapper[data-v-b1d35174]{align-items:center;background:#373737;border:1px solid #d4d4d4;border-radius:8px;display:flex;gap:12px;height:68px;justify-content:space-between;opacity:1;padding:12px;width:100%}.comment-input[data-v-b1d35174]{background:transparent;border:none;flex:1;font-size:16px;outline:none;padding:0}.comment-input[data-v-b1d35174]::-moz-placeholder{color:#999}.comment-input[data-v-b1d35174]::placeholder{color:#999}.comment-send-button[data-v-b1d35174]{width:125px}.comment-reply-button[data-v-b1d35174],.comment-send-button[data-v-b1d35174]{align-items:center;background:#1b6be5;border:none;border-radius:8px;cursor:pointer;display:flex;flex-shrink:0;font-size:14px;font-weight:600;gap:8px;height:44px;justify-content:center;opacity:1;padding:10px 24px;transition:background .3s ease,transform .2s ease}.comment-reply-button[data-v-b1d35174]{width:150px}.comment-send-button[data-v-b1d35174]:hover{background:#1557b8;transform:translateY(-1px)}.comment-send-button[data-v-b1d35174]:active{transform:translateY(0)}.comment-send-button svg[data-v-b1d35174]{margin-left:4px}.error-message[data-v-b1d35174]{color:#f44;font-size:14px;margin-bottom:16px;margin-top:-16px;padding-right:58px}#comments[data-v-b1d35174]{margin-top:32px}.comment-item[data-v-b1d35174]{margin-bottom:24px}.replies-container[data-v-b1d35174]{margin-right:58px;margin-top:16px}@media (max-width:768px){.comments-container[data-v-b1d35174]{margin:0;max-width:1292px;width:100%}.input-box-wrapper[data-v-b1d35174]{align-items:stretch;flex-direction:column;height:auto;max-width:100%;min-height:68px;padding:16px}.comment-send-button[data-v-b1d35174]{width:100%}.reply-input-wrapper[data-v-b1d35174]{margin-left:20px;margin-right:0}.replies-container[data-v-b1d35174]{margin-right:20px}.user-avatar[data-v-b1d35174]{border-radius:20px;height:40px;width:40px}.comments-count-header[data-v-b1d35174]{font-size:18px}}@media (max-width:480px){.comment-input-wrapper[data-v-b1d35174]{align-items:stretch;flex-direction:column}.user-avatar[data-v-b1d35174]{align-self:flex-start}.input-box-wrapper[data-v-b1d35174]{width:100%}}",""]),r.locals={},e.exports=r}}]);