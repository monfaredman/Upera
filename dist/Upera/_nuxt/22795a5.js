(window.webpackJsonp=window.webpackJsonp||[]).push([[1,93],{1003:function(t,e){},1025:function(t,e,n){"use strict";n(911)},722:function(t,e,n){"use strict";n.r(e);var r=n(3),l=(n(17),n(68),n(83),n(13),n(46),n(40),n(21),n(22),n(316),n(41)),o=n(70),c=n(71),d=n(214),v=n(104),h=n(144),f=(n(32),n(118),n(78),n(67),n(136),n(999),n(18),n(11),n(29),n(57),n(95),n(55),n(170),n(1e3),n(166),n(80),n(16),n(60),n(91),n(311),n(312),n(116),n(35)),m=n(855),y=(n(1053),n(1023),n(1024)),S=n(945);function w(t,e,n){return e=Object(v.a)(e),Object(d.a)(t,C()?Reflect.construct(e,n||[],Object(v.a)(t).constructor):e.apply(t,n))}function C(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(C=function(){return!!t})()}function _(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,a){if(t){if("string"==typeof t)return k(t,a);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?k(t,a):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,l=function(){};return{s:l,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function k(t,a){(null==a||a>t.length)&&(a=t.length);for(var e=0,n=Array(a);e<a;e++)n[e]=t[e];return n}function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function T(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach(function(e){Object(r.a)(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var P=n(515),O=n(513),L=n(518),E=n(517),B=n(519),A=n(516),I=n(512),j=n(514),D=[{value:.5,label:"۰.۵x"},{value:.75,label:"۰.۷۵x"},{value:1,label:"۱x (عادی)"},{value:1.25,label:"۱.۲۵x"},{value:1.5,label:"۱.۵x"},{value:1.75,label:"۱.۷۵x"},{value:2,label:"۲x"}],V={fa:"فارسی",en:"English",ar:"العربية",fr:"Français",de:"Deutsch",es:"Español"},F={"1080p":"۱۰۸۰p - Full HD","720p":"۷۲۰p - HD","480p":"۴۸۰p - SD","360p":"۳۶۰p","240p":"۲۴۰p",auto:"خودکار",Auto:"خودکار"},M={components:{SubscriptionButton:S.default},props:{stream:{type:String,default:""},playerid:{type:String,default:""},title:{type:String,default:""},showAutoPlayToggle:{type:Boolean,default:!0},vastUrl:{type:String,default:""},posterUrl:{type:String,default:""},playerAutoPlay:{type:Boolean,default:!0},tracks:{type:Array,default:function(){return[]}},hasPlaylist:{type:Boolean,default:!1},shouldIncrementViews:{type:Boolean,default:!1},videoid:{type:String,default:""},videotype:{type:String,default:""},muteOnOtherPlay:{type:Boolean,default:!1},creditsData:{type:Object,default:function(){return{first_credits:1,after_credits:60,final_credits:5550}}},showSkipCreditsButton:{type:Boolean,default:!0},fullrateData:{type:Object,default:null},contentId:{type:[String,Number],default:null},contentType:{type:String,default:""}},data:function(){return{FONT_SIZES:[{value:20,label:"کوچک"},{value:24,label:"متوسط"},{value:28,label:"بزرگ"},{value:32,label:"خیلی بزرگ"}],TEXT_COLORS:[{value:"#ffffff",label:"سفید",class:"color-white"},{value:"#ffff00",label:"زرد",class:"color-yellow"},{value:"#00ff00",label:"سبز",class:"color-green"},{value:"#00ffff",label:"فیروزه‌ای",class:"color-cyan"},{value:"#ffa500",label:"نارنجی",class:"color-orange"}],BACKGROUND_OPACITIES:[{value:0,label:"بدون پس‌زمینه"},{value:.5,label:"نیمه شفاف"},{value:.8,label:"مات",selected:!0},{value:1,label:"کاملاً مات"}],TEXT_SHADOWS:[{value:"none",label:"بدون سایه"},{value:"light",label:"سایه کم"},{value:"medium",label:"سایه متوسط"},{value:"heavy",label:"سایه زیاد"}],adActive:!1,viewsIncremented:!1,player:null,showSkipCredits:!1,skipButtonText:"رد کردن تیتراژ",currentCreditType:null,creditCheckInterval:null,isMobile:!1,isUltraWideScreen:!1,currentTimeFormatted:"00:00",durationFormatted:"00:00",showSettingsDrawer:!1,settingsDrawerView:"main",currentPlaybackRate:1,currentSubtitle:null,currentQuality:"auto",subtitleTracksInitialized:!1,subtitleStyle:{fontSize:24,color:"#ffffff",background:.8,shadow:"medium"},subtitleFontMin:18,subtitleFontMax:64,subtitleFontStep:2,showProgressPreview:!1,previewPosition:{x:0,y:0},previewTime:"00:00",progressBarElement:null,lastPreviewTime:-1,audioOptions:null,currentAudioLang:null,currentStream:null,volumeRestoreInterval:null,savedVolumeState:null,volumeSaveInterval:null}},computed:T(T({},Object(f.c)({autoPlay:"autoplay"})),{},{displayTitle:function(){return this.adActive?"نمایش تبلیغات":this.title},isRtl:function(){return"fa"===this.$i18n.locale},PLAYBACK_RATES:function(){return D},subtitleFontSizePx:function(){return this.resolveSubtitleFontPx(this.subtitleStyle.fontSize)}}),watch:{stream:function(t){t&&(this.parseAudioOptionsFromStream(t),this.currentStream=t,this.initPlayer())},autoPlay:function(){this.player&&this.updateIcon()},"$i18n.locale":function(t){this.player&&(this.player.language(t),this.player.el().style.direction="fa"===t?"rtl":"ltr")},showSettingsDrawer:function(t){var e=this;t&&this.$nextTick(function(){e.moveDrawerToPlayer()})}},mounted:function(){this.updateResponsiveFlags(),window.addEventListener("resize",this.handleResize),this.stream&&this.initPlayer(),window.addEventListener("keydown",this.handleKeydown),window.addEventListener("beforeunload",this.saveVolumeState)},beforeDestroy:function(){this.saveVolumeState(),this.stopVolumeRestoreMonitoring(),this.stopVolumeSaveMonitoring(),this.player&&this.player.dispose(),this.creditCheckInterval&&clearInterval(this.creditCheckInterval),this.cueObserver&&this.cueObserver.disconnect();var t=document.getElementById("custom-subtitle-styles");t&&t.remove(),window.removeEventListener("keydown",this.handleKeydown),window.removeEventListener("resize",this.handleResize),window.removeEventListener("beforeunload",this.saveVolumeState)},methods:T(T({},Object(f.b)(["SET_AUTOPLAY"])),{},{handleSubscriptionClick:function(data){this.$emit("subscription-purchase",data),this.$store&&this.$store.dispatch&&this.$store.dispatch("subscription/SHOW_MODAL",{content_type:data.type,content_id:data.id})},handleResize:function(){this.updateResponsiveFlags()},updateResponsiveFlags:function(){var t=window.innerWidth;this.isMobile=t<=768,this.isUltraWideScreen=t>2e3},initPlayer:function(){var t=this.$i18n.locale;"fa"===t&&m.default.addLanguage("fa",y);var e=!(!this.playerAutoPlay||!1===this.autoPlay);this.parseAudioOptionsFromStream(this.stream),console.log("[VideoPlayer] Parsed audio options:",this.audioOptions);var n=this.currentStream||this.stream;try{var r=localStorage.getItem("".concat(this.playerid,"-audioLang"));if(r&&this.audioOptions){var l=this.audioOptions.find(function(t){return t.lang===r});l&&(console.log("[VideoPlayer] Using persisted audio:",r),n=this.buildStreamWithAudio(this.stream,l.lang),this.currentAudioLang=l.lang)}else if(this.audioOptions){var o=this.audioOptions.find(function(t){return t.lang&&"fa"===t.lang.toString().toLowerCase()});if(o)console.log("[VideoPlayer] Using FA audio as default"),n=this.buildStreamWithAudio(this.stream,o.lang),this.currentAudioLang=o.lang;else{var c,d=new URL(this.stream,window.location.origin),v=new URLSearchParams(d.search),h=!1,f=_(v.keys());try{for(f.s();!(c=f.n()).done;){var S=c.value;if(/^audio\[.+\]$/.test(S)){h=!0;break}}}catch(t){f.e(t)}finally{f.f()}!h&&this.audioOptions&&this.audioOptions.length>0&&(console.log("[VideoPlayer] No audio param in URL, assuming first option as default:",this.audioOptions[0].lang),this.currentAudioLang=this.audioOptions[0].lang)}}}catch(t){console.warn("[VideoPlayer] Error initializing audio state:",t)}console.log("[VideoPlayer] Initial audio lang:",this.currentAudioLang),console.log("[VideoPlayer] Initial stream:",n),this.currentStream=n,this.player=Object(m.default)(this.playerid,{autoplay:e,controls:!0,controlBar:{children:["progressControl","playToggle","volumePanel","fullscreenToggle"]},fluid:!0,poster:this.posterUrl,language:t,sources:[{src:n,type:"application/x-mpegURL"}]}),this.player.addClass("vjs-split-controls"),this.applyRtlSettings(),this.setupVastPlugin(),this.setupPlayerEvents()},applyRtlSettings:function(){var t=this.$refs[this.playerid];t&&(t.classList.toggle("vjs-rtl",this.isRtl),t.style.direction=this.isRtl?"rtl":"ltr")},setupVastPlugin:function(){if(this.vastUrl){var t={vastUrl:this.vastUrl,playAdAlways:!0,withCredentials:!1,mediaFileRegex:/.*/,addCtaClickZone:!1,timeout:5,skipButtonOptions:{text:"رد کردن >>"}};this.player.vast(t),this.setupVastCtaButton()}},setupVastCtaButton:function(){var t=document.getElementById("vast-cta-btn");if(t){this.player.on("vast.play",function(e,n){var r=n.ctaUrl,l=n.adClickCallback,o=n.adTitle;t.innerText=o,r&&(t.style.display="block",t.onclick=function(){l(),window.open(r,"_blank")})});var e=function(){t.style.display="none"};this.player.on("vast.complete",e),this.player.on("vast.error",e)}},setupAdEvents:function(){var t=this;this.player.on("vast.play",function(){t.adActive=!0}),this.player.on(["vast.complete","vast.skip"],function(){t.adActive=!1})},setupTextTracks:function(){var t,e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==(t=this.tracks)&&void 0!==t&&t.length&&(!this.subtitleTracksInitialized||n)){console.log("[VideoPlayer] Setting up text tracks. Current audio lang:",this.currentAudioLang);for(var r=this.player.remoteTextTracks(),i=r.length-1;i>=0;i--)this.player.removeRemoteTextTrack(r[i]);this.tracks.forEach(function(track){e.player.addRemoteTextTrack({kind:track.kind,src:track.src,label:track.label,srclang:track.language||"",default:track.default||!1},!1).track.mode="disabled"});for(var l=-1,o=0;o<this.tracks.length;o++){var c=this.tracks[o],d=(c.language||c.label||"").toString().toLowerCase();if("fa"===d||"farsi"===d||d.includes("fa")){l=o;break}}var v=this.player.textTracks();if(this.currentAudioLang&&"fa"===this.currentAudioLang.toString().toLowerCase()){console.log("[VideoPlayer] FA audio detected, disabling all subtitles");for(var h=0;h<v.length;h++)v[h].mode="disabled";this.currentSubtitle=null}else if(this.currentAudioLang&&"en"===this.currentAudioLang.toString().toLowerCase())if(-1!==l){console.log("[VideoPlayer] EN audio detected, enabling FA subtitle at index:",l);for(var f=0;f<v.length;f++)v[f].mode=f===l?"showing":"disabled";this.currentSubtitle=l}else{console.log("[VideoPlayer] EN audio but no FA subtitle found, disabling all");for(var m=0;m<v.length;m++)v[m].mode="disabled";this.currentSubtitle=null}else if(console.log("[VideoPlayer] Audio language unknown, applying fallback logic"),-1!==l){console.log("[VideoPlayer] Enabling FA subtitle as fallback at index:",l);for(var y=0;y<v.length;y++)v[y].mode=y===l?"showing":"disabled";this.currentSubtitle=l}else{for(var S=!1,w=0;w<this.tracks.length;w++)if(this.tracks[w].default){v[w].mode="showing",this.currentSubtitle=w,S=!0;break}if(!S){for(var C=0;C<v.length;C++)v[C].mode="disabled";this.currentSubtitle=null}}this.subtitleTracksInitialized=!0}},setupCustomButtons:function(){this.createRuntimeDisplay(),this.hasPlaylist&&this.createPlaylistButton(),this.createNextButton(),this.createPipButton(),this.createSettingsButton(),this.isRtl&&this.createCustomRTLVolumeControl(),this.showAutoPlayToggle&&this.createSkipButtons()},getFullscreenInsertIndex:function(){var t=this.player.controlBar.getChild("fullscreenToggle"),e=this.player.controlBar.children().indexOf(t);return-1===e?this.player.controlBar.children().length-1:e},createNextButton:function(){var t=m.default.getComponent("Button"),e=j,n=function(t){function n(t,r){var l;Object(o.a)(this,n),(l=w(this,n,[t,r])).addClass("vjs-next-button"),l.addClass("vjs-custom-icon-button"),l.controlText("قسمت بعد");var img=document.createElement("img");return img.src=e,img.className="vjs-button-icon",l.el().appendChild(img),l}return Object(h.a)(n,t),Object(c.a)(n,[{key:"handleClick",value:function(){this.player().trigger("ended")}}])}(t);m.default.registerComponent("NextButton",n),this.player.controlBar.addChild("NextButton",{},this.getFullscreenInsertIndex())},createPipButton:function(){var t=function(t){function e(t,n){var r;Object(o.a)(this,e),(r=w(this,e,[t,n])).addClass("vjs-pip-button"),r.controlText("تصویر در تصویر");var l=document.createElement("span");return l.className="vjs-icon-pip",l.innerHTML='<i class="fa fa-clone"></i>',r.el().appendChild(l),r}return Object(h.a)(e,t),Object(c.a)(e,[{key:"handleClick",value:function(){var t=this.player().el().querySelector("video");t&&(document.pictureInPictureElement?document.exitPictureInPicture():t.requestPictureInPicture&&t.requestPictureInPicture().catch(function(t){console.error("Picture-in-Picture error:",t)}))}}])}(m.default.getComponent("Button"));m.default.registerComponent("PipButton",t),this.player.controlBar.addChild("PipButton",{},this.getFullscreenInsertIndex())},createSettingsButton:function(){var t=m.default.getComponent("Button"),e=this,n=A,r=function(t){function r(t,e){var l;Object(o.a)(this,r),(l=w(this,r,[t,e])).addClass("vjs-settings-button"),l.addClass("vjs-custom-icon-button"),l.controlText("تنظیمات");var img=document.createElement("img");return img.src=n,img.className="vjs-button-icon",l.el().appendChild(img),l}return Object(h.a)(r,t),Object(c.a)(r,[{key:"handleClick",value:function(){e.toggleSettingsDrawer()}}])}(t);m.default.registerComponent("SettingsButton",r),this.player.controlBar.addChild("SettingsButton",{},this.getFullscreenInsertIndex())},toggleSettingsDrawer:function(){this.showSettingsDrawer=!this.showSettingsDrawer,this.showSettingsDrawer&&(this.settingsDrawerView="main")},closeSettingsDrawer:function(){this.showSettingsDrawer=!1,this.settingsDrawerView="main"},backToMain:function(){this.settingsDrawerView="main"},openSpeedSettings:function(){this.settingsDrawerView="speed"},openSubtitleSettings:function(){this.settingsDrawerView="subtitle"},openQualitySettings:function(){this.settingsDrawerView="quality"},getSpeedLabel:function(){var t=this,e=D.find(function(e){return e.value===t.currentPlaybackRate});return e?e.label:"۱x (عادی)"},getSubtitleLabel:function(){var t=this;if(null===this.currentSubtitle)return"خاموش";var track=this.getSubtitleTracks().find(function(e){return e.index===t.currentSubtitle});return(null==track?void 0:track.label)||"خاموش"},getQualityLabel:function(){return F[this.currentQuality]||"خودکار"},isSpeedActive:function(t){return Math.abs(this.currentPlaybackRate-t)<.01},selectSpeed:function(t){this.currentPlaybackRate=t,this.player&&this.player.playbackRate(t),this.closeSettingsDrawer()},getSubtitleTracks:function(){if(!this.player)return[];for(var t=this.player.textTracks(),e=[],i=0;i<t.length;i++){var track=t[i];if("subtitles"===track.kind||"captions"===track.kind){var n=V[track.language]||track.label||"زبان ".concat(i+1);e.push({label:n,language:track.language,index:i})}}return e},selectSubtitle:function(t){if(this.currentSubtitle=t,this.player){for(var e=this.player.textTracks(),i=0;i<e.length;i++)e[i].mode="disabled";null!==t&&e[t]&&(e[t].mode="showing")}this.closeSettingsDrawer()},getAvailableQualities:function(){return[{value:"auto",label:"خودکار"},{value:"1080p",label:"۱۰۸۰p - Full HD"},{value:"720p",label:"۷۲۰p - HD"},{value:"480p",label:"۴۸۰p - SD"},{value:"360p",label:"۳۶۰p"}]},isQualityActive:function(t){return this.currentQuality===t},selectQuality:function(t){if(this.currentQuality=t,this.player&&this.player.qualityLevels){var e=this.player.qualityLevels();if("auto"===t)for(var i=0;i<e.length;i++)e[i].enabled=!0;else for(var n=0;n<e.length;n++){var r=e[n].height;e[n].enabled=r+"p"===t}}this.closeSettingsDrawer()},createCustomRTLVolumeControl:function(){var t=this.player.controlBar.getChild("volumePanel");t&&this.player.controlBar.removeChild(t);var e=function(t){function e(t,n){var r;return Object(o.a)(this,e),(r=w(this,e,[t,n])).addClass("vjs-custom-rtl-volume"),r.volumeLevel=t.volume(),r.isDragging=!1,r.touchHandled=!1,r.createVolumeElements(),r.attachEventHandlers(),r.updateVolumeDisplay(),r.updateMuteIcon(),t.on("volumechange",function(){r.volumeLevel=t.volume(),r.updateVolumeDisplay(),r.updateMuteIcon()}),r}return Object(h.a)(e,t),Object(c.a)(e,[{key:"saveVolumeState",value:function(){try{var t=this.player().id(),e={volume:this.player().volume(),muted:this.player().muted()};localStorage.setItem("".concat(t,"-volumeState"),JSON.stringify(e))}catch(t){console.warn("[VideoPlayer] Error saving volume state in control:",t)}}},{key:"createVolumeElements",value:function(){this.el().innerHTML='\n        <button class="vjs-rtl-volume-button vjs-control vjs-button vjs-custom-icon-button" type="button">\n          <img class="vjs-button-icon" />\n        </button>\n        <div class="vjs-rtl-volume-control vjs-control">\n          <div class="vjs-rtl-volume-bar">\n            <div class="vjs-rtl-volume-level">\n              <span class="vjs-rtl-volume-handle"></span>\n            </div>\n          </div>\n        </div>\n      '}},{key:"attachEventHandlers",value:function(){var t=this,button=this.el().querySelector(".vjs-rtl-volume-button"),e=this.el().querySelector(".vjs-rtl-volume-control"),n=this.el().querySelector(".vjs-rtl-volume-bar");if(button){var r=function(e){e&&(e.stopPropagation(),e.preventDefault());var n=t.player();n.muted()?(n.muted(!1),t.lastVolume&&t.lastVolume>0?n.volume(t.lastVolume):0===n.volume()&&n.volume(.5)):(t.lastVolume=n.volume(),n.muted(!0)),t.saveVolumeState(),t.updateMuteIcon()},l=0;button.addEventListener("touchstart",function(){l=Date.now(),t.touchHandled=!1},{passive:!0}),button.addEventListener("touchend",function(e){Date.now()-l<500&&(t.touchHandled=!0,r(e),e.preventDefault(),e.stopPropagation(),setTimeout(function(){t.touchHandled=!1},300))},{passive:!1}),button.addEventListener("click",function(e){t.touchHandled||r(e),t.touchHandled=!1}),this.el().addEventListener("mouseenter",function(){e.classList.add("vjs-slider-active")}),this.el().addEventListener("mouseleave",function(){t.isDragging||e.classList.remove("vjs-slider-active")}),n.addEventListener("mousedown",function(n){t.isDragging=!0,t.updateVolumeFromEvent(n);var r=function(e){t.isDragging&&t.updateVolumeFromEvent(e)},l=function(){t.isDragging=!1,e.classList.remove("vjs-slider-active"),document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",l)};document.addEventListener("mousemove",r),document.addEventListener("mouseup",l)}),n.addEventListener("click",function(e){t.updateVolumeFromEvent(e)})}else console.warn("[VideoPlayer] Volume button not found")}},{key:"updateVolumeFromEvent",value:function(t){var rect=this.el().querySelector(".vjs-rtl-volume-bar").getBoundingClientRect(),e=(t.clientX-rect.left)/rect.width;e=Math.max(0,Math.min(1,e)),this.volumeLevel=e,this.player().volume(e),this.saveVolumeState()}},{key:"updateVolumeDisplay",value:function(){var t=this.el().querySelector(".vjs-rtl-volume-level");if(t){var e=100*this.volumeLevel;t.style.width="".concat(e,"%")}}},{key:"updateMuteIcon",value:function(){var button=this.el().querySelector(".vjs-rtl-volume-button"),img=this.el().querySelector(".vjs-button-icon");if(button&&img){var t=this.player();if(t.muted())img.src=B,img.alt="Unmute";else{var e=t.volume();img.src=e<.5?E:L,img.alt="Mute"}}}},{key:"createEl",value:function(){return m.default.dom.createEl("div",{className:"vjs-custom-rtl-volume vjs-volume-panel vjs-control vjs-volume-panel-horizontal"})}}])}(m.default.getComponent("Component"));m.default.registerComponent("CustomRTLVolumeControl",e);var n,r=this.player.controlBar.getChild("Next10Button"),l=this.player.controlBar.getChild("playToggle");n=r?this.player.controlBar.children().indexOf(r)+1:l?this.player.controlBar.children().indexOf(l)+1:1;var d=this.player.controlBar.addChild("CustomRTLVolumeControl",{},n);setTimeout(function(){d&&d.updateMuteIcon&&d.updateMuteIcon()},100)},createPlaylistButton:function(){var t=this,e=m.default.getComponent("Button"),n=I,r=function(t){function e(t,r){var l;Object(o.a)(this,e),(l=w(this,e,[t,r])).addClass("vjs-playlist-button"),l.addClass("vjs-custom-icon-button"),l.controlText("انتخاب فصل و قسمت");var img=document.createElement("img");return img.src=n,img.className="vjs-button-icon",l.el().appendChild(img),l}return Object(h.a)(e,t),Object(c.a)(e,[{key:"handleClick",value:function(){this.player().trigger("playlistButtonClick")}}])}(e);m.default.registerComponent("PlaylistButton",r),this.player.controlBar.addChild("PlaylistButton",{},this.player.controlBar.children().length-1),this.player.on("playlistButtonClick",function(){t.$emit("playlistButtonClick")})},createSkipButtons:function(){if(!this.isMobile){var t=m.default.getComponent("Button"),e=function(t){function e(t,n){var r;Object(o.a)(this,e),(r=w(this,e,[t,n])).addClass("vjs-prev10-button"),r.controlText("10 ثانیه قبل");var l=document.createElement("img");return l.src=P,l.style.width="20px",l.style.height="20px",l.alt="10 seconds back",r.el().appendChild(l),r}return Object(h.a)(e,t),Object(c.a)(e,[{key:"handleClick",value:function(){var t=this.player().currentTime();this.player().currentTime(Math.max(t-10,0))}}])}(t),n=function(t){function e(t,n){var r;Object(o.a)(this,e),(r=w(this,e,[t,n])).addClass("vjs-next10-button"),r.controlText("10 ثانیه بعد");var l=document.createElement("img");return l.src=O,l.style.width="20px",l.style.height="20px",l.alt="10 seconds forward",r.el().appendChild(l),r}return Object(h.a)(e,t),Object(c.a)(e,[{key:"handleClick",value:function(){var t=this.player().currentTime(),e=this.player().duration();this.player().currentTime(Math.min(t+10,e))}}])}(t);m.default.registerComponent("Prev10Button",e),m.default.registerComponent("Next10Button",n);var r=this.player.controlBar.getChild("PlayToggle"),l=this.player.controlBar.children().indexOf(r);this.player.controlBar.addChild("Prev10Button",{},l),this.player.controlBar.addChild("Next10Button",{},l+2)}},setupPlaybackEvents:function(){var t=this;this.player.on("play",function(){t.handlePlayEvent()}),this.player.on("timeupdate",function(){var e=t.player.currentTime(),n=t.player.duration();t.currentTimeFormatted=t.formatTime(e),t.durationFormatted=t.formatTime(n),t.$emit("timeupdate",{currentTime:e,duration:n,player:t.player})}),this.player.on("ended",function(){t.autoPlay&&t.$emit("ended")})},formatTime:function(t){if(!t||isNaN(t))return"00:00";var e=Math.floor(t/3600),n=Math.floor(t%3600/60),r=Math.floor(t%60);return e>0?"".concat(e.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"),":").concat(r.toString().padStart(2,"0")):"".concat(n.toString().padStart(2,"0"),":").concat(r.toString().padStart(2,"0"))},handlePlayEvent:function(){var t=this;!this.viewsIncremented&&this.shouldIncrementViews&&this.videoid&&this.$axios.$post("/nocache/videos/".concat(this.videoid,"/increment-views"),{videotype:this.videotype}).then(function(){t.viewsIncremented=!0}).catch(function(t){console.error("Error incrementing views:",t)}),this.muteOnOtherPlay&&this.$emit("video-played",this.playerid)},customizeQualityLabels:function(){var t=this;this.player.el().querySelector(".vjs-quality-selector")&&new MutationObserver(function(){t.player.el().querySelectorAll(".vjs-quality-selector .vjs-menu-item").forEach(function(t){var text=t.textContent.trim();F[text]&&(t.textContent=F[text])})}).observe(this.player.el(),{childList:!0,subtree:!0})},play:function(){var t;null===(t=this.player)||void 0===t||t.play()},pause:function(){var t;null===(t=this.player)||void 0===t||t.pause()},updateIcon:function(){var button=this.player.controlBar.getChild("AutoPlayButton");null==button||button.updateIcon()},handleKeydown:function(t){var e=this;if(this.player){var n={ArrowLeft:function(){return e.seekBackward()},ArrowRight:function(){return e.seekForward()},ArrowUp:function(){return e.volumeUp()},ArrowDown:function(){return e.volumeDown()}," ":function(){return e.togglePlayPause(t)}}[t.key];n&&n()}},seekBackward:function(){var t=Math.max(this.player.currentTime()-10,0);this.player.currentTime(t)},seekForward:function(){var t=Math.min(this.player.currentTime()+10,this.player.duration());this.player.currentTime(t)},saveVolumeState:function(){if(this.player)try{var t={volume:this.player.volume(),muted:this.player.muted()};localStorage.setItem("".concat(this.playerid,"-volumeState"),JSON.stringify(t))}catch(t){console.warn("[VideoPlayer] Error saving volume state:",t)}},restoreVolumeState:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.player)return!1;try{var e=localStorage.getItem("".concat(this.playerid,"-volumeState"));if(!e)return!1;var n=JSON.parse(e);this.savedVolumeState=n;var r=null;try{if(!(r=this.player.el().querySelector("video"))){var l=this.player.tech({IWillNotUseThisInPlugins:!0});l&&l.el_&&(r=l.el_)}!r&&this.player.el_&&(r=this.player.el_)}catch(t){}var o=!1;if("number"==typeof n.volume&&n.volume>=0&&n.volume<=1){var c=this.player.volume();(t||Math.abs(c-n.volume)>.01)&&(this.player.volume(n.volume),r&&"VIDEO"===r.tagName&&(r.volume=n.volume),o=!0)}if("boolean"==typeof n.muted){var d=this.player.muted();(t||d!==n.muted)&&(this.player.muted(n.muted),r&&"VIDEO"===r.tagName&&(r.muted=n.muted),o=!0)}return o}catch(t){return console.warn("[VideoPlayer] Error restoring volume state:",t),!1}},startVolumeRestoreMonitoring:function(){var t=this;this.volumeRestoreInterval&&clearInterval(this.volumeRestoreInterval);var e=0;this.volumeRestoreInterval=setInterval(function(){if(!t.player||e>=25)return clearInterval(t.volumeRestoreInterval),void(t.volumeRestoreInterval=null);e++,t.restoreVolumeState()&&!t.player.paused()&&e>5&&(clearInterval(t.volumeRestoreInterval),t.volumeRestoreInterval=null)},200)},stopVolumeRestoreMonitoring:function(){this.volumeRestoreInterval&&(clearInterval(this.volumeRestoreInterval),this.volumeRestoreInterval=null)},startVolumeSaveMonitoring:function(){var t=this;this.volumeSaveInterval&&clearInterval(this.volumeSaveInterval),this.volumeSaveInterval=setInterval(function(){if(!t.player)return clearInterval(t.volumeSaveInterval),void(t.volumeSaveInterval=null);t.saveVolumeState()},2e3)},stopVolumeSaveMonitoring:function(){this.volumeSaveInterval&&(clearInterval(this.volumeSaveInterval),this.volumeSaveInterval=null)},volumeUp:function(){var t=Math.min(this.player.volume()+.1,1);this.player.volume(t),this.saveVolumeState()},volumeDown:function(){var t=Math.max(this.player.volume()-.1,0);this.player.volume(t),this.saveVolumeState()},togglePlayPause:function(t){t.preventDefault(),this.player.paused()?this.player.play():this.player.pause()},createRuntimeDisplay:function(){var t=function(t){function e(){return Object(o.a)(this,e),w(this,e,arguments)}return Object(h.a)(e,t),Object(c.a)(e,[{key:"updateText",value:function(){var t=this.player().currentTime(),e=this.player().duration(),n=function(t){if(!t||isNaN(t))return"00:00";var e=Math.floor(t/3600),n=Math.floor(t%3600/60),r=Math.floor(t%60);return e>0?"".concat(e.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"),":").concat(r.toString().padStart(2,"0")):"".concat(n.toString().padStart(2,"0"),":").concat(r.toString().padStart(2,"0"))},r=n(t),l=n(e);this.el().innerHTML="".concat(r," / ").concat(l)}}])}(m.default.getComponent("Component"));m.default.registerComponent("RuntimeDisplay",t);var e,n=this.player.controlBar,r=n.getChild("volumePanel"),l=n.getChild("fullscreenToggle");e=r?n.children().indexOf(r)+1:l?n.children().indexOf(l):n.children().length-2,n.addChild("RuntimeDisplay",{},e)},setupCreditsSkip:function(){var t=this;this.creditCheckInterval&&clearInterval(this.creditCheckInterval),this.creditCheckInterval=setInterval(function(){t.checkCreditsPosition()},1e3),this.player.on("dispose",function(){t.creditCheckInterval&&clearInterval(t.creditCheckInterval)})},checkCreditsPosition:function(){if(this.player&&!this.player.paused()){var t=this.player.currentTime();this.isInFirstCredits(t)?(this.showSkipCredits=!0,this.currentCreditType="first_credits",this.skipButtonText="رد کردن تیتراژ"):(this.showSkipCredits=!1,this.currentCreditType=null)}},isInFirstCredits:function(t){var e=this.creditsData,n=e.first_credits,r=e.after_credits;return n>=0&&t>n&&t<r},isInFinalCredits:function(t,e){var n=this.creditsData.final_credits;return t>=(n>0?n:.9*e)&&e>0},skipCredits:function(){var t=this;if(this.player){var e={first_credits:function(){t.player.currentTime(t.creditsData.after_credits||60)},final_credits:function(){var e=t.player.duration();t.player.currentTime(e-1),t.$emit("credits-skipped","final_credits")}}[this.currentCreditType];e&&e(),this.showSkipCredits=!1,this.currentCreditType=null}},setupAutoHideControls:function(){var t=this;if(this.player){var e=null,n=function(){if(!t.player.paused()){t.player.userActive(!1);var e=document.querySelector(".video-title-bottom"),n=document.querySelector(".video-timer-bottom"),r=document.querySelector(".skip-credits-btn"),l=document.querySelector(".back-button"),o=document.querySelector(".site-logo"),c=document.querySelector(".vjs-control-bar");e&&(e.style.opacity="0"),n&&(n.style.opacity="0"),r&&(r.style.opacity="0"),l&&(l.style.opacity="0"),o&&(o.style.opacity="0"),c&&c.style.setProperty("opacity","0","important")}},r=function(){t.player.userActive(!0);var e=document.querySelector(".video-title-bottom"),n=document.querySelector(".video-timer-bottom"),r=document.querySelector(".skip-credits-btn"),l=document.querySelector(".back-button"),o=document.querySelector(".site-logo"),c=document.querySelector(".vjs-control-bar");e&&(e.style.opacity="1"),n&&(n.style.opacity="1"),r&&(r.style.opacity="1"),l&&(l.style.opacity="1"),o&&(o.style.opacity="1"),c&&c.style.setProperty("opacity","1","important")},l=function(){clearTimeout(e),r(),t.player.paused()||(e=setTimeout(n,3e3))},o=this.player.el();o.addEventListener("mousemove",l),o.addEventListener("touchstart",l,{passive:!1}),o.addEventListener("touchmove",l,{passive:!1}),o.addEventListener("touchend",l,{passive:!1}),o.addEventListener("click",l);var c=o.querySelector(".vjs-control-bar");c&&(c.addEventListener("touchstart",l,{passive:!1}),c.addEventListener("touchmove",l,{passive:!1}),c.addEventListener("touchend",l,{passive:!1})),this.player.on("pause",function(){clearTimeout(e),r()}),this.player.on("play",l),this.player.on("playing",l),this.player.on("dispose",function(){clearTimeout(e)}),this.player.paused()||l()}},setupPlayerEvents:function(){var t=this;this.player.ready(function(){if(t.restoreVolumeState(!0),t.setupAdEvents(),t.setupTextTracks(),t.setupCustomButtons(),t.setupPlaybackEvents(),t.setupCreditsSkip(),t.applySubtitleStyles(),t.setupProgressBarPreview(),t.currentPlaybackRate=t.player.playbackRate(),t.initializeSubtitleState(),t.initializeAudioState(),t.player.on("volumechange",function(){t.saveVolumeState()}),t.startVolumeRestoreMonitoring(),t.startVolumeSaveMonitoring(),t.player.on("loadedmetadata",function(){setTimeout(function(){t.restoreVolumeState(!0)},100)}),t.player.on("playing",function(){setTimeout(function(){t.restoreVolumeState(!0)},50)}),t.detectActualAudioTrack(),t.setupFullscreenCustomOverlays(),t.setupAutoHideControls(),"fa"===t.$i18n.locale){var e,n=null===(e=t.player.controlBar)||void 0===e||null===(e=e.getChild("volumePanel"))||void 0===e||null===(e=e.volumeControl)||void 0===e?void 0:e.volumeBar;if(n){var r=n.handleMouseMove;n.handleMouseMove=function(t){if(t){var rect=this.el_.getBoundingClientRect(),e=t.clientX-rect.left,n=rect.width-e,l=new MouseEvent(t.type,{clientX:rect.left+n,clientY:t.clientY,bubbles:!0});return r.call(this,l)}return r.call(this,t)}}}if(!(!t.playerAutoPlay||!1===t.autoPlay)){var l=null;try{var o=localStorage.getItem("".concat(t.playerid,"-volumeState"));if(o){var c=JSON.parse(o);l=c.muted}}catch(t){}var d=t.player.play();d&&"function"==typeof d.then&&d.catch(function(){if(null===l||!0===l)try{t.player.muted(!0),t.player.play().catch(function(){}),null===l&&t.saveVolumeState()}catch(t){}})}})},setupFullscreenCustomOverlays:function(){var t=this;if(this.player){var e=this.player.el(),n=function(){var n=document.getElementById("".concat(t.playerid,"-skip-credits")),r=document.getElementById("".concat(t.playerid,"-title")),l=document.getElementById("".concat(t.playerid,"-timer"));n&&!e.contains(n)&&e.appendChild(n),r&&!e.contains(r)&&e.appendChild(r),l&&!e.contains(l)&&e.appendChild(l),t.moveDrawerToPlayer()};this.player.on("fullscreenchange",function(){var r,l,o,c,d;t.player.isFullscreen()?n():(r=e.parentElement,l=document.getElementById("".concat(t.playerid,"-skip-credits")),o=document.getElementById("".concat(t.playerid,"-title")),c=document.getElementById("".concat(t.playerid,"-timer")),d=document.getElementById("".concat(t.playerid,"-settings-drawer")),l&&e.contains(l)&&r.appendChild(l),o&&e.contains(o)&&r.appendChild(o),c&&e.contains(c)&&r.appendChild(c),d&&e.contains(d)&&r.appendChild(d))}),setTimeout(function(){n()},100)}},moveDrawerToPlayer:function(){if(this.player){var t=this.player.el(),e=this.$refs.settingsDrawer;e||(e=document.getElementById("".concat(this.playerid,"-settings-drawer"))),e&&!t.contains(e)&&t.appendChild(e)}},initializeSubtitleState:function(){if(this.player){for(var t=this.player.textTracks(),e=!1,i=0;i<t.length;i++)if("showing"===t[i].mode){this.currentSubtitle=i,e=!0;break}e||(this.currentSubtitle=null)}},detectActualAudioTrack:function(){var t=this;this.player&&this.player.on("loadedmetadata",function(){try{var e=t.player.tech({IWillNotUseThisInPlugins:!0});if(e&&e.vhs){var n=e.audioTracks();if(n&&n.length>0)for(var i=0;i<n.length;i++)if(n[i].enabled){var r=(n[i].label||n[i].language||"").toLowerCase(),l=null;r.includes("fa")||r.includes("farsi")||r.includes("persian")?l="FA":(r.includes("en")||r.includes("english"))&&(l="EN"),!l||t.currentAudioLang&&t.currentAudioLang===l||(console.log("Detected actual audio track:",l),t.currentAudioLang=l,t.syncSubtitlesWithAudio());break}}}catch(t){console.warn("Could not detect audio track:",t)}})},syncSubtitlesWithAudio:function(){if(this.player&&this.tracks&&0!==this.tracks.length){for(var t=this.player.textTracks(),e=-1,i=0;i<this.tracks.length;i++){var n=this.tracks[i],r=(n.language||n.label||"").toString().toLowerCase();if("fa"===r||"farsi"===r||r.includes("fa")){e=i;break}}if(this.currentAudioLang&&"fa"===this.currentAudioLang.toString().toLowerCase()){for(var l=0;l<t.length;l++)t[l].mode="disabled";this.currentSubtitle=null}else if(this.currentAudioLang&&-1!==e){for(var o=0;o<t.length;o++)t[o].mode=o===e?"showing":"disabled";this.currentSubtitle=e}}},parseAudioOptionsFromStream:function(t){try{if(!t)return void(this.audioOptions=null);var e,n=new URL(t,window.location.origin),r=new URLSearchParams(n.search),o=[],c=_(r.entries());try{for(c.s();!(e=c.n()).done;){var d=Object(l.a)(e.value,2),v=d[0],h=d[1],f=v.match(/^audio\[(.+)\]$/);if(f){var m=f[1],label=V[m.toLowerCase()]||m;"fa"===m.toLowerCase()||"FA"===m?label="دوبله":"en"!==m.toLowerCase()&&"EN"!==m||(label="زبان اصلی"),o.push({lang:m,token:h,label:label})}}}catch(t){c.e(t)}finally{c.f()}this.audioOptions=o.length?o:null}catch(t){console.warn("parseAudioOptionsFromStream error",t),this.audioOptions=null}},buildStreamWithAudio:function(t,e){try{if(!t)return t;for(var n=new URL(t,window.location.origin),r=new URLSearchParams(n.search),l=0,o=Array.from(r.keys());l<o.length;l++){var c=o[l];/^audio\[.+\]$/.test(c)&&r.delete(c)}if(e){var d,v=null===(d=this.audioOptions)||void 0===d?void 0:d.find(function(t){return t.lang===e});v&&r.set("audio[".concat(v.lang,"]"),v.token)}return n.search=r.toString(),n.toString()}catch(e){return console.warn("buildStreamWithAudio error",e),t}},initializeAudioState:function(){},openAudioSettings:function(){this.settingsDrawerView="audio"},getAudioLabelDisplay:function(){var t=this;if(!this.audioOptions)return"پیش‌فرض";if(!this.currentAudioLang)return"پیش‌فرض";var e=this.audioOptions.find(function(e){return e.lang===t.currentAudioLang});return e?e.label:"پیش‌فرض"},selectAudio:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.player){this.currentAudioLang=t;try{t?localStorage.setItem("".concat(this.playerid,"-audioLang"),t):localStorage.removeItem("".concat(this.playerid,"-audioLang"))}catch(t){console.warn("parseAudioOptionsFromStream error",t)}try{var r=this.stream,l=this.buildStreamWithAudio(r,t);this.currentStream=l;var o=this.player.currentTime(),c=!this.player.paused();this.player.pause(),this.player.src({src:l,type:"application/x-mpegURL"}),this.player.one("loadedmetadata",function(){try{if(!isNaN(o)&&o>0){var t=e.player.duration();(!t||o<=t)&&e.player.currentTime(o)}}catch(t){console.warn("seek after audio change failed",t)}try{e.setupTextTracks(!0)}catch(t){console.warn("reinit subtitles after audio change failed",t)}c&&e.player.play().catch(function(){})})}catch(t){console.error("selectAudio error",t)}n.preserveDrawer||this.closeSettingsDrawer()}else this.currentAudioLang=t},openSubtitleStyleSettings:function(){this.settingsDrawerView="subtitle-style"},backToSubtitleSettings:function(){this.settingsDrawerView="subtitle"},updateSubtitleStyle:function(t,e){this.subtitleStyle[t]=e,this.applySubtitleStyles()},handleSubtitleFontInput:function(t){var e,n=Number(null==t||null===(e=t.target)||void 0===e?void 0:e.value);if(!Number.isNaN(n)){var r=this.clampSubtitleFontSize(n);this.updateSubtitleFontSize(r),t&&t.target&&(t.target.value=r)}},adjustSubtitleFontSize:function(t){"number"==typeof t&&this.updateSubtitleFontSize(this.subtitleFontSizePx+t)},updateSubtitleFontSize:function(t){var e=this.clampSubtitleFontSize(t);this.updateSubtitleStyle("fontSize",e)},clampSubtitleFontSize:function(t){var e=Number(t);return Number.isNaN(e)?24:Math.min(this.subtitleFontMax,Math.max(this.subtitleFontMin,Math.round(e)))},resolveSubtitleFontPx:function(t){if("number"==typeof t)return t;return{small:20,medium:24,large:28,"x-large":32}[t]||24},applySubtitleStyles:function(){if(this.player){var t=this.player.el().querySelector(".vjs-text-track-display");if(t){var e="".concat(this.subtitleFontSizePx,"px");t.style.cssText+="font-size: ".concat(e," !important;"),this.updateExistingCues(),this.setupCueObserver(),this.injectSubtitleStyles()}}},setupCueObserver:function(){var t=this,e=this.player.el().querySelector(".vjs-text-track-display");e&&(this.cueObserver&&this.cueObserver.disconnect(),this.cueObserver=new MutationObserver(function(e){e.forEach(function(e){"childList"===e.type&&e.addedNodes.forEach(function(e){e.classList&&e.classList.contains("vjs-text-track-cue")&&t.applyCueStyles(e)})})}),this.cueObserver.observe(e,{childList:!0,subtree:!0}))},updateExistingCues:function(){var t=this,e=this.player.el().querySelector(".vjs-text-track-display");e&&e.querySelectorAll(".vjs-text-track-cue").forEach(function(e){t.applyCueStyles(e)})},applyCueStyles:function(t){var e=t.querySelector("div");if(e){var n="".concat(this.subtitleFontSizePx,"px"),r="\n    font-size: ".concat(n," !important;\n    color: ").concat(this.subtitleStyle.color," !important;\n    background-color: rgba(0, 0, 0, ").concat(this.subtitleStyle.background,") !important;\n    padding: ").concat(this.subtitleStyle.background>0?"4px 8px":"0",' !important;\n    border-radius: 4px !important;\n    font-family: Arial, "Segoe UI", Tahoma, sans-serif !important;\n    font-weight: bold !important;\n    line-height: 1.4 !important;\n  '),l={none:"none",light:"0 1px 2px rgba(0,0,0,0.8) !important",medium:"0 2px 4px rgba(0,0,0,0.8) !important",heavy:"0 3px 6px rgba(0,0,0,0.8), 0 1px 2px rgba(0,0,0,0.9) !important"}[this.subtitleStyle.shadow]||"none";e.style.cssText+=r+"text-shadow: ".concat(l,";"),t.style.cssText+="font-size: ".concat(n," !important;")}},injectSubtitleStyles:function(){var t=document.getElementById("custom-subtitle-styles");t&&t.remove();var style=document.createElement("style");style.id="custom-subtitle-styles";var e="".concat(this.subtitleFontSizePx,"px"),n={none:"none",light:"0 1px 2px rgba(0,0,0,0.8)",medium:"0 2px 4px rgba(0,0,0,0.8)",heavy:"0 3px 6px rgba(0,0,0,0.8), 0 1px 2px rgba(0,0,0,0.9)"}[this.subtitleStyle.shadow]||"none";style.textContent="\n    .vjs-text-track-display {\n      font-size: ".concat(e," !important;\n    }\n    .vjs-text-track-cue {\n      font-size: ").concat(e," !important;\n    }\n    .vjs-text-track-cue div {\n      font-size: ").concat(e," !important;\n      color: ").concat(this.subtitleStyle.color," !important;\n      background-color: rgba(0, 0, 0, ").concat(this.subtitleStyle.background,") !important;\n      padding: ").concat(this.subtitleStyle.background>0?"4px 8px":"0",' !important;\n      border-radius: 4px !important;\n      font-family: Arial, "Segoe UI", Tahoma, sans-serif !important;\n      font-weight: bold !important;\n      text-shadow: ').concat(n," !important;\n      line-height: 1.4 !important;\n    }\n  "),document.head.appendChild(style)},resetSubtitleStyles:function(){this.subtitleStyle={fontSize:24,color:"#ffffff",background:.8,shadow:"medium"},this.applySubtitleStyles()},setupProgressBarPreview:function(){var t=this;if(this.player){var e=this.player.controlBar.getChild("progressControl");e&&(this.progressBarElement=e.el(),this.progressBarElement.addEventListener("mouseenter",this.handleProgressBarEnter),this.progressBarElement.addEventListener("mousemove",this.handleProgressBarMove),this.progressBarElement.addEventListener("mouseleave",this.handleProgressBarLeave),this.player.on("dispose",function(){t.progressBarElement&&(t.progressBarElement.removeEventListener("mouseenter",t.handleProgressBarEnter),t.progressBarElement.removeEventListener("mousemove",t.handleProgressBarMove),t.progressBarElement.removeEventListener("mouseleave",t.handleProgressBarLeave))}))}},handleProgressBarEnter:function(){this.showProgressPreview=!0,this.lastPreviewTime=-1},handleProgressBarMove:function(t){if(this.player&&this.progressBarElement){var rect=this.progressBarElement.getBoundingClientRect(),e=this.player.duration();if(e&&!isNaN(e)){var n=t.clientX-rect.left,r=Math.max(0,Math.min(1,n/rect.width))*e,l=Math.round(r);this.previewTime=this.formatTime(l);var o=t.clientX-rect.left-80;o=Math.max(10,Math.min(o,rect.width-160-10)),this.previewPosition.x=o+14}}},handleProgressBarLeave:function(){this.showProgressPreview=!1},generateThumbnailPreview:function(time){if(this.player&&this.$refs.previewCanvas){var canvas=this.$refs.previewCanvas,t=canvas.getContext("2d"),e=this.player.el().querySelector("video");if(e)try{var n=document.createElement("video");n.src=e.src||e.currentSrc,n.crossOrigin="anonymous",n.muted=!0,n.currentTime=time,n.addEventListener("loadeddata",function(){t.drawImage(n,0,0,canvas.width,canvas.height),n.remove()}),n.addEventListener("error",function(){t.fillStyle="#1a1a1a",t.fillRect(0,0,canvas.width,canvas.height),t.fillStyle="#ffffff",t.font="14px Arial",t.textAlign="center",t.fillText("پیش‌نمایش",canvas.width/2,canvas.height/2),n.remove()})}catch(e){t.fillStyle="#1a1a1a",t.fillRect(0,0,canvas.width,canvas.height),t.fillStyle="#ffffff",t.font="14px Arial",t.textAlign="center",t.fillText("پیش‌نمایش",canvas.width/2,canvas.height/2)}}}})},R=M,N=(n(1025),n(28)),component=Object(N.a)(R,function(){var t=this,e=t._self._c;return e("div",{staticStyle:{position:"relative"}},[!t.stream&&t.posterUrl?e("div",{staticClass:"video-placeholder",style:{backgroundImage:"url(".concat(t.posterUrl,")")}},[t.title?e("div",{staticClass:"video-title-overlay"},[t._v("\n      "+t._s(t.displayTitle)+"\n    ")]):t._e()]):e("video",{directives:[{name:"lazy-load",rawName:"v-lazy-load"}],ref:t.playerid,staticClass:"video-js vjs-default-skin vjs-theme-fantasy vjs-big-play-centered vjs-16-9",staticStyle:{width:"100%",height:"100%","border-radius":"0.375rem"},attrs:{id:t.playerid,controls:"",preload:"auto",playsinline:"","webkit-playsinline":"","x5-playsinline":"","data-poster":t.posterUrl}}),t._v(" "),t.showSkipCredits&&t.stream&&t.showSkipCreditsButton?e("button",{staticClass:"skip-credits-btn",attrs:{id:"".concat(t.playerid,"-skip-credits")},on:{click:t.skipCredits}},[t._v("\n    "+t._s(t.skipButtonText)+"\n    "),t._m(0)]):t._e(),t._v(" "),t.title&&t.stream?e("div",{staticClass:"video-title-bottom",attrs:{id:"".concat(t.playerid,"-title")}},[t._v("\n    "+t._s(t.displayTitle)+"\n  ")]):t._e(),t._v(" "),t.stream?e("div",{staticClass:"video-timer-bottom",attrs:{id:"".concat(t.playerid,"-timer")}},[t._v("\n    "+t._s(t.currentTimeFormatted)+" / "+t._s(t.durationFormatted)+"\n  ")]):t._e(),t._v(" "),t.stream&&t.showProgressPreview?e("div",{ref:"progressPreview",staticClass:"progress-preview-popover",style:{left:t.previewPosition.x+"px"},attrs:{id:"".concat(t.playerid,"-progress-preview")}},[e("div",{staticClass:"preview-thumbnail"},[e("canvas",{ref:"previewCanvas",attrs:{width:"160",height:"90"}})]),t._v(" "),e("div",{staticClass:"preview-time"},[t._v(t._s(t.previewTime))])]):t._e(),t._v(" "),e("button",{attrs:{id:"vast-cta-btn"}},[t._v("اطلاعات بیشتر")]),t._v(" "),t.fullrateData&&t.contentId&&t.contentType?e("SubscriptionButton",{attrs:{"fullrate-data":t.fullrateData,"content-id":t.contentId,"content-type":t.contentType},on:{"subscription-click":t.handleSubscriptionClick}}):t._e(),t._v(" "),t.showSettingsDrawer?e("div",{ref:"settingsDrawer",staticClass:"settings-drawer-overlay",attrs:{id:"".concat(t.playerid,"-settings-drawer")},on:{click:t.closeSettingsDrawer}},[e("div",{staticClass:"settings-drawer",class:{"mobile-drawer":t.isMobile},on:{click:function(t){t.stopPropagation()}}},["main"===t.settingsDrawerView?e("div",{staticClass:"drawer-content"},[t._m(1),t._v(" "),e("div",{staticClass:"drawer-body"},[e("div",{staticClass:"drawer-item",on:{click:t.openSpeedSettings}},[t._m(2),t._v(" "),e("div",{staticClass:"drawer-item-info"},[e("div",{staticClass:"drawer-item-title"},[t._v("سرعت پخش")]),t._v(" "),e("div",{staticClass:"drawer-item-value"},[t._v(t._s(t.getSpeedLabel()))])]),t._v(" "),t._m(3)]),t._v(" "),t.tracks&&t.tracks.length>0?e("div",{staticClass:"drawer-item",on:{click:t.openSubtitleSettings}},[t._m(4),t._v(" "),e("div",{staticClass:"drawer-item-info"},[e("div",{staticClass:"drawer-item-title"},[t._v("زیرنویس")]),t._v(" "),e("div",{staticClass:"drawer-item-value"},[t._v(t._s(t.getSubtitleLabel()))])]),t._v(" "),t._m(5)]):t._e(),t._v(" "),e("div",{staticClass:"drawer-item",on:{click:t.openQualitySettings}},[t._m(6),t._v(" "),e("div",{staticClass:"drawer-item-info"},[e("div",{staticClass:"drawer-item-title"},[t._v("کیفیت")]),t._v(" "),e("div",{staticClass:"drawer-item-value"},[t._v(t._s(t.getQualityLabel()))])]),t._v(" "),t._m(7)]),t._v(" "),t.audioOptions&&t.audioOptions.length>0?e("div",{staticClass:"drawer-item",on:{click:t.openAudioSettings}},[t._m(8),t._v(" "),e("div",{staticClass:"drawer-item-info"},[e("div",{staticClass:"drawer-item-title"},[t._v("صدا")]),t._v(" "),e("div",{staticClass:"drawer-item-value"},[t._v("\n                "+t._s(t.getAudioLabelDisplay())+"\n              ")])]),t._v(" "),t._m(9)]):t._e()])]):t._e(),t._v(" "),"subtitle-style"===t.settingsDrawerView?e("div",{staticClass:"drawer-content"},[e("div",{staticClass:"drawer-header with-back"},[e("button",{staticClass:"back-button",on:{click:t.backToSubtitleSettings}},[e("i",{staticClass:"fa fa-chevron-right"})]),t._v(" "),e("h3",[t._v("تنظیمات ظاهر زیرنویس")])]),t._v(" "),e("div",{staticClass:"drawer-divider"}),t._v(" "),e("div",{staticClass:"drawer-body px-4"},[e("div",{staticClass:"subtitle-style-group"},[e("label",{staticClass:"subtitle-style-label"},[t._v("اندازه فونت")]),t._v(" "),t.isUltraWideScreen?e("div",{staticClass:"subtitle-font-custom-control"},[e("button",{staticClass:"subtitle-font-btn",attrs:{type:"button",disabled:t.subtitleFontSizePx<=t.subtitleFontMin},on:{click:function(e){return t.adjustSubtitleFontSize(-t.subtitleFontStep)}}},[e("i",{staticClass:"fa fa-minus"})]),t._v(" "),e("input",{staticClass:"subtitle-font-input",attrs:{type:"number",min:t.subtitleFontMin,max:t.subtitleFontMax,step:t.subtitleFontStep},domProps:{value:t.subtitleFontSizePx},on:{input:function(e){return t.handleSubtitleFontInput(e)}}}),t._v(" "),e("span",{staticClass:"subtitle-font-unit"},[t._v("px")]),t._v(" "),e("button",{staticClass:"subtitle-font-btn",attrs:{type:"button",disabled:t.subtitleFontSizePx>=t.subtitleFontMax},on:{click:function(e){return t.adjustSubtitleFontSize(t.subtitleFontStep)}}},[e("i",{staticClass:"fa fa-plus"})])]):e("div",{staticClass:"subtitle-style-options"},t._l(t.FONT_SIZES,function(n){return e("div",{key:n.value,staticClass:"subtitle-style-option",class:{active:t.subtitleStyle.fontSize===n.value},on:{click:function(e){return t.updateSubtitleStyle("fontSize",n.value)}}},[t._v("\n                "+t._s(n.label)+"\n              ")])}),0)]),t._v(" "),e("div",{staticClass:"subtitle-style-group"},[e("label",{staticClass:"subtitle-style-label"},[t._v("رنگ متن")]),t._v(" "),e("div",{staticClass:"subtitle-style-options"},t._l(t.TEXT_COLORS,function(n){return e("div",{key:n.value,staticClass:"subtitle-style-option color-option",class:Object(r.a)({active:t.subtitleStyle.color===n.value},n.class,!0),on:{click:function(e){return t.updateSubtitleStyle("color",n.value)}}},[e("div",{staticClass:"color-preview",style:{backgroundColor:n.value}}),t._v(" "),e("span",[t._v(t._s(n.label))])])}),0)]),t._v(" "),e("div",{staticClass:"subtitle-style-group"},[e("label",{staticClass:"subtitle-style-label"},[t._v("پس‌زمینه")]),t._v(" "),e("div",{staticClass:"subtitle-style-options"},t._l(t.BACKGROUND_OPACITIES,function(n){return e("div",{key:n.value,staticClass:"subtitle-style-option",class:{active:t.subtitleStyle.background===n.value},on:{click:function(e){return t.updateSubtitleStyle("background",n.value)}}},[e("div",{staticClass:"bg-preview",style:{opacity:n.value}}),t._v(" "),e("span",[t._v(t._s(n.label))])])}),0)]),t._v(" "),e("div",{staticClass:"subtitle-style-group"},[e("label",{staticClass:"subtitle-style-label"},[t._v("سایه متن")]),t._v(" "),e("div",{staticClass:"subtitle-style-options"},t._l(t.TEXT_SHADOWS,function(shadow){return e("div",{key:shadow.value,staticClass:"subtitle-style-option",class:{active:t.subtitleStyle.shadow===shadow.value},on:{click:function(e){return t.updateSubtitleStyle("shadow",shadow.value)}}},[t._v("\n                "+t._s(shadow.label)+"\n              ")])}),0)]),t._v(" "),e("div",{staticClass:"subtitle-style-actions"},[e("button",{staticClass:"reset-default-btn",on:{click:t.resetSubtitleStyles}},[t._v("\n              بازنشانی به پیش‌فرض\n            ")])])])]):t._e(),t._v(" "),"speed"===t.settingsDrawerView?e("div",{staticClass:"drawer-content"},[e("div",{staticClass:"drawer-header with-back"},[e("button",{staticClass:"back-button",on:{click:t.backToMain}},[e("i",{staticClass:"fa fa-chevron-right"})]),t._v(" "),e("h3",[t._v("سرعت پخش")])]),t._v(" "),e("div",{staticClass:"drawer-divider"}),t._v(" "),e("div",{staticClass:"drawer-body"},t._l(t.PLAYBACK_RATES,function(n){return e("div",{key:n.value,staticClass:"drawer-option",class:{active:t.isSpeedActive(n.value)},on:{click:function(e){return t.selectSpeed(n.value)}}},[e("div",{staticClass:"drawer-option-radio"},[t.isSpeedActive(n.value)?e("div",{staticClass:"radio-checked"}):t._e()]),t._v(" "),e("div",{staticClass:"drawer-option-label"},[t._v(t._s(n.label))])])}),0)]):t._e(),t._v(" "),"subtitle"===t.settingsDrawerView?e("div",{staticClass:"drawer-content"},[e("div",{staticClass:"drawer-header with-back"},[e("button",{staticClass:"back-button",on:{click:t.backToMain}},[e("i",{staticClass:"fa fa-chevron-right"})]),t._v(" "),e("h3",[t._v("زیرنویس")])]),t._v(" "),e("div",{staticClass:"drawer-divider"}),t._v(" "),e("div",{staticClass:"drawer-body"},[e("div",{staticClass:"drawer-option",class:{active:null===t.currentSubtitle},on:{click:function(e){return t.selectSubtitle(null)}}},[e("div",{staticClass:"drawer-option-radio"},[null===t.currentSubtitle?e("div",{staticClass:"radio-checked"}):t._e()]),t._v(" "),e("div",{staticClass:"drawer-option-label"},[t._v("خاموش")])]),t._v(" "),t._l(t.getSubtitleTracks(),function(track,n){return e("div",{key:n,staticClass:"drawer-option",class:{active:t.currentSubtitle===n},on:{click:function(e){return t.selectSubtitle(n)}}},[e("div",{staticClass:"drawer-option-radio"},[t.currentSubtitle===n?e("div",{staticClass:"radio-checked"}):t._e()]),t._v(" "),e("div",{staticClass:"drawer-option-label"},[t._v(t._s(track.label))])])}),t._v(" "),e("div",{staticClass:"drawer-divider"}),t._v(" "),e("div",{staticClass:"drawer-item",on:{click:t.openSubtitleStyleSettings}},[t._m(10),t._v(" "),t._m(11),t._v(" "),t._m(12)])],2)]):t._e(),t._v(" "),"audio"===t.settingsDrawerView?e("div",{staticClass:"drawer-content"},[e("div",{staticClass:"drawer-header with-back"},[e("button",{staticClass:"back-button",on:{click:t.backToMain}},[e("i",{staticClass:"fa fa-chevron-right"})]),t._v(" "),e("h3",[t._v("صدا")])]),t._v(" "),e("div",{staticClass:"drawer-divider"}),t._v(" "),e("div",{staticClass:"drawer-body"},[e("div",{staticClass:"drawer-option",class:{active:null===t.currentAudioLang},on:{click:function(e){return t.selectAudio(null)}}},[e("div",{staticClass:"drawer-option-radio"},[null===t.currentAudioLang?e("div",{staticClass:"radio-checked"}):t._e()]),t._v(" "),e("div",{staticClass:"drawer-option-label"},[t._v("پیش‌فرض")])]),t._v(" "),t._l(t.audioOptions,function(n){return e("div",{key:n.lang,staticClass:"drawer-option",class:{active:t.currentAudioLang===n.lang},on:{click:function(e){return t.selectAudio(n.lang)}}},[e("div",{staticClass:"drawer-option-radio"},[t.currentAudioLang===n.lang?e("div",{staticClass:"radio-checked"}):t._e()]),t._v(" "),e("div",{staticClass:"drawer-option-label"},[t._v(t._s(n.label))])])})],2)]):t._e(),t._v(" "),"quality"===t.settingsDrawerView?e("div",{staticClass:"drawer-content"},[e("div",{staticClass:"drawer-header with-back"},[e("button",{staticClass:"back-button",on:{click:t.backToMain}},[e("i",{staticClass:"fa fa-chevron-right"})]),t._v(" "),e("h3",[t._v("کیفیت")])]),t._v(" "),e("div",{staticClass:"drawer-divider"}),t._v(" "),e("div",{staticClass:"drawer-body"},t._l(t.getAvailableQualities(),function(n){return e("div",{key:n.value,staticClass:"drawer-option",class:{active:t.isQualityActive(n.value)},on:{click:function(e){return t.selectQuality(n.value)}}},[e("div",{staticClass:"drawer-option-radio"},[t.isQualityActive(n.value)?e("div",{staticClass:"radio-checked"}):t._e()]),t._v(" "),e("div",{staticClass:"drawer-option-label"},[t._v(t._s(n.label))])])}),0)]):t._e()])]):t._e()],1)},[function(){var t=this._self._c;return t("span",{staticClass:"skip-icon"},[t("i",{staticClass:"fa fa-forward"})])},function(){var t=this._self._c;return t("div",{staticClass:"drawer-header"},[t("h3",[this._v("تنظیمات")])])},function(){var t=this._self._c;return t("div",{staticClass:"drawer-item-icon"},[t("i",{staticClass:"fa fa-clock"})])},function(){var t=this._self._c;return t("div",{staticClass:"drawer-item-arrow"},[t("i",{staticClass:"fa fa-chevron-left"})])},function(){var t=this._self._c;return t("div",{staticClass:"drawer-item-icon"},[t("i",{staticClass:"fa fa-closed-captioning"})])},function(){var t=this._self._c;return t("div",{staticClass:"drawer-item-arrow"},[t("i",{staticClass:"fa fa-chevron-left"})])},function(){var t=this._self._c;return t("div",{staticClass:"drawer-item-icon"},[t("i",{staticClass:"fa fa-video"})])},function(){var t=this._self._c;return t("div",{staticClass:"drawer-item-arrow"},[t("i",{staticClass:"fa fa-chevron-left"})])},function(){var t=this._self._c;return t("div",{staticClass:"drawer-item-icon"},[t("i",{staticClass:"fa fa-headphones"})])},function(){var t=this._self._c;return t("div",{staticClass:"drawer-item-arrow"},[t("i",{staticClass:"fa fa-chevron-left"})])},function(){var t=this._self._c;return t("div",{staticClass:"drawer-item-icon"},[t("i",{staticClass:"fa fa-cog"})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"drawer-item-info"},[e("div",{staticClass:"drawer-item-title"},[t._v("تنظیمات زیرنویس")]),t._v(" "),e("div",{staticClass:"drawer-item-value"},[t._v("سایز، رنگ، پس‌زمینه")])])},function(){var t=this._self._c;return t("div",{staticClass:"drawer-item-arrow"},[t("i",{staticClass:"fa fa-chevron-left"})])}],!1,null,"bf1cc6c2",null);e.default=component.exports},851:function(t,e,n){t.exports={}},883:function(t,e,n){"use strict";n(851)},911:function(t,e,n){t.exports={}},945:function(t,e,n){"use strict";n.r(e);n(136),n(91);var r={name:"SubscriptionButton",props:{fullrateData:{type:Object,default:function(){return{rate:.5,show_subscription:0,fa:{title:"نیم بها",alternative:"نیم بها"},en:{title:"Half-priced",alternative:"Half-priced"}}}},contentId:{type:[String,Number],required:!0},contentType:{type:String,required:!0}},data:function(){return{isVisible:!0,hideTimer:null}},computed:{shouldShow:function(){return this.fullrateData&&1===this.fullrateData.show_subscription},showHalfPriceLabel:function(){return 1===this.fullrateData.rate},buttonText:function(){return"fa"===this.$i18n.locale?"خرید اشتراک":"Buy Subscription"},usageVolumeText:function(){var t,e;return"fa"===this.$i18n.locale?"حجم مصرفی: ".concat((null===(e=this.fullrateData.fa)||void 0===e?void 0:e.title)||"نیم بها"):"Usage Volume: ".concat((null===(t=this.fullrateData.en)||void 0===t?void 0:t.title)||"Half-priced")}},mounted:function(){var t=this;this.hideTimer=setTimeout(function(){t.isVisible=!1},1e4)},beforeDestroy:function(){this.hideTimer&&clearTimeout(this.hideTimer)},methods:{handleSubscriptionClick:function(){this.$emit("subscription-click",{id:this.contentId,type:this.contentType})}}},l=(n(883),n(28)),component=Object(l.a)(r,function(){var t=this,e=t._self._c;return e("transition",{attrs:{name:"fade"}},[t.isVisible&&t.shouldShow?e("button",{staticClass:"subscription-floating-button",on:{click:t.handleSubscriptionClick}},[e("i",{staticClass:"fa fa-money-bill"}),t._v(" "),e("span",{staticClass:"button-text"},[t._v("\n      "+t._s(t.buttonText)+"\n      "),t.showHalfPriceLabel?e("span",{staticClass:"half-price-label"},[t._v("\n        ("+t._s(t.usageVolumeText)+")\n      ")]):t._e()])]):t._e()])},[],!1,null,"5e5fcf10",null);e.default=component.exports}}]);