(window.webpackJsonp=window.webpackJsonp||[]).push([[125],{1010:function(e,t,a){"use strict";a(873)},1077:function(e,t,a){"use strict";a.r(t);var o=a(27),s=(a(64),a(35),a(73),a(45),a(43),a(13),a(101),a(60),a(65),{components:{VideoPlayer:function(){return Promise.resolve().then(a.bind(null,750))}},beforeRouteLeave:function(e,t,a){if(this.$swal&&this.$swal.close)try{this.$swal.close()}catch(e){}a()},layout:"empty",data:function(){return{movieTitle:"",posterUrl:"",creditsData:{},videoUrl:"",vastUrl:"",tracks:[],loading:!0,guest:!0,show_report:!1,report_problem_type:null,report_details:"",report_button:!1,soon:!1,reportOptions:[{value:1,label:"report.labeling_problem"},{value:2,label:"report.video_problem"},{value:3,label:"report.sound_problem"},{value:4,label:"report.caption_problem"}],recentlyTime:200,showNextMovie:!1,suggestion:null,suggestionBackdrop:"",startTime:0,fullrateData:null,contentType:"video"}},mounted:function(){window.innerWidth<=767.98&&(document.documentElement.classList.add("video-page-mobile"),document.body.classList.add("video-page-mobile")),this.$auth&&this.$auth.loggedIn&&(this.guest=!1),this.loadMovie(),window.addEventListener("popstate",this.handlePopState)},beforeDestroy:function(){if(document.documentElement.classList.remove("video-page-mobile"),document.body.classList.remove("video-page-mobile"),this.$swal&&this.$swal.close)try{this.$swal.close()}catch(e){}window.removeEventListener("popstate",this.handlePopState)},methods:{handlePopState:function(){if(this.$swal&&this.$swal.close)try{this.$swal.close()}catch(e){}},showErrorAlert:function(e){var t=this,a="fa"===this.$i18n.locale?e.message_fa:e.message;a||(a=this.$t("player.error1"));var o={back:{text:this.$t("player.back"),value:"back",closeModal:!0,className:"swal-back"}};1===e.show_download&&(o.download={text:this.$t("player.download"),value:"download",closeModal:!0}),1===e.show_ekran&&(o.download={text:this.$t("show.buy_ticket"),value:"download",closeModal:!0}),1===e.show_subscription&&(o.subscribe={text:this.$t("player.subscribe"),value:"subscribe",closeModal:!0}),this.$auth.loggedIn||1!==e.show_login||Object.assign(o,{login:{text:this.$t("nav.login"),value:"login",closeModal:!0}}),this.$swal({title:a,icon:"error",dangerMode:!0,buttons:o}).then(function(e){switch(e){case"back":default:window.history.length>2?t.$router.go(-1):t.$router.push({name:"movie-id",params:{id:t.$route.params.id}});break;case"subscribe":t.$store.dispatch("subscription/SHOW_MODAL",{content_type:"movie",content_id:t.$route.params.id});break;case"download":t.$router.push({name:"movie-payment-id",params:{id:t.$route.params.id},query:{force_to_buy:1}});break;case"login":t.$store.dispatch("login/SHOW_MODAL",{premessage:null,premobile:null,preredirect:null,prerefresh:!1})}})},loadMovie:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark(function t(){var a,o,s,r,i,n,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a=e.$route.params.id){t.next=1;break}return t.abrupt("return");case 1:return o=e.$cookiz.get("ref")||"",s=e.guest?"/ghost/get/watch/movie-hls/".concat(a,"/1").concat(o?"?ref=".concat(o):""):"/get/watch/movie-hls/".concat(a,"/1").concat(o?"?ref=".concat(o):""),t.next=2,e.$axios.get(s);case 2:if(200!==(r=t.sent).status){t.next=4;break}return i=r.data.data,e.movieTitle="fa"===e.$i18n.locale&&i.video[0].name_fa?i.video[0].name_fa:i.video[0].name,e.posterUrl=i.cdn.lg_backdrop+i.video[0].backdrop,n=i.video[0].video.includes("?")?i.video[0].video+"&nosub=1":i.video[0].video+"?nosub=1",e.startTime=i.video[0].current_time||0,e.creditsData={first_credits:i.first_credits||null,after_credits:i.after_credits||null,final_credits:i.final_credits||null},i.fullrate_data&&(e.fullrateData=i.fullrate_data),t.next=3,fetch(n,{method:"HEAD"});case 3:t.sent.ok?(e.videoUrl=n,e.vastUrl=i.vast,e.soon=!1):e.soon=!0,i.new_subtitle&&Array.isArray(i.new_subtitle)&&(e.tracks=i.new_subtitle.map(function(e,t){return{kind:"captions",label:e.language,src:e.url,default:0===t}})),i.suggestion&&(e.suggestion=i.suggestion,e.suggestionBackdrop=i.cdn.md_backdrop+i.suggestion.backdrop),t.next=5;break;case 4:e.showErrorAlert(r.data.data);case 5:t.next=7;break;case 6:t.prev=6,l=t.catch(0),e.showErrorAlert(l.response.data);case 7:return t.prev=7,e.loading=!1,t.finish(7);case 8:case"end":return t.stop()}},t,null,[[0,6,7,8]])}))()},handlePlayerReady:function(e){this.startTime&&e.currentTime&&e.currentTime(this.startTime)},handleTimeUpdate:function(e){var t=e.currentTime,a=e.duration,o=e.player;if(Math.floor(t)>=this.recentlyTime){this.recentlyTime=Math.floor(t)+200;var s={current_time:Math.floor(t),duration_time:Math.floor(a),movie_id:this.$route.params.id};this.guest?this.$axios.post("/ghost/create/watch/movie/recently",s):this.$axios.post("/create/watch/movie/recently",s)}return this.creditsData.final_credits&&t>=this.creditsData.final_credits&&this.suggestion||!this.creditsData.final_credits&&a-t<=100&&this.suggestion?this.showNextMovie=!0:this.showNextMovie=!1,o},handleEnded:function(){this.suggestion&&this.playNextMovie()},playNextMovie:function(){this.$router.push({name:"movie-show-id",params:{id:this.suggestion.id}})},goBack:function(){window.history.length>2?this.$router.go(-1):this.$router.push({name:"movie-id",params:{id:this.$route.params.id}})},openReport:function(){var e;this.show_report=!0;var t=null===(e=this.$refs.moviePlayer)||void 0===e?void 0:e.player;t&&t.pause()},closeReport:function(){var e;this.show_report=!1;var t=null===(e=this.$refs.moviePlayer)||void 0===e?void 0:e.player;t&&t.play()},sendReport:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark(function t(){var a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.report_button=!0,t.prev=1,a={type:e.report_problem_type,details:e.report_details,id:e.$route.params.id},t.next=2,e.$axios.post("/create/report/movie",a);case 2:"success"===t.sent.data.status&&(e.report_button=!1,e.closeReport(),e.$alertify.logPosition("top right"),e.$alertify.success("Successful Send, our team will check it soon")),t.next=4;break;case 3:t.prev=3,t.catch(1),e.report_button=!1;case 4:case"end":return t.stop()}},t,null,[[1,3]])}))()}}}),r=(a(1010),a(32)),i=Object(r.a)(s,function(){var e=this,t=e._self._c;return t("div",{staticClass:"video-container"},[t("div",{staticClass:"hamshahri"},[t("div",{staticClass:"site-logo"},[t("img",{directives:[{name:"lazy-load",rawName:"v-lazy-load"},{name:"lazy",rawName:"v-lazy",value:a(469),expression:"require('@/assets/images/logo-mobile.svg')"}],attrs:{"data-src":a(469),alt:"Logo",loading:"lazy"}})]),e._v(" "),t("button",{staticClass:"back-button",on:{click:e.goBack}},[t("p",{staticClass:"back-text"},[e._v("بازگشت")]),e._v(" "),t("i",{staticClass:"fa fa-chevron-left",staticStyle:{color:"white"}})]),e._v(" "),e.loading?t("div",{staticClass:"video-loading-spinner"}):e._e(),e._v(" "),e.soon?t("p",{staticClass:"soon"},[e._v("به زودی...")]):e._e(),e._v(" "),e.soon?t("button",{staticClass:"btn btn-primary btn-lg fw-bold refresh-btn",on:{click:e.reloadPage}},[e._v("\n      بارگذاری مجدد\n    ")]):e._e()]),e._v(" "),t("div",{staticClass:"player-wrapper"},[e.videoUrl&&!e.loading?t("VideoPlayer",{directives:[{name:"lazy-load",rawName:"v-lazy-load"}],ref:"moviePlayer",staticClass:"full-screen-player vjs-fluid",attrs:{playerid:"movie-player",stream:e.videoUrl,"data-poster":e.posterUrl,title:e.movieTitle,"vast-url":e.vastUrl||"",tracks:e.tracks,"player-auto-play":!0,"fullrate-data":e.fullrateData,"content-id":e.$route.params.id,"content-type":e.contentType,"credits-data":e.creditsData},on:{"credits-skipped":e.handleEnded,ready:e.handlePlayerReady,timeupdate:e.handleTimeUpdate,ended:e.handleEnded}}):e._e()],1),e._v(" "),e.showNextMovie&&e.suggestion?t("div",{staticClass:"next-movie-overlay",on:{click:e.playNextMovie}},[t("div",{staticClass:"next-movie-content"},[t("p",[e._v(e._s(e.$t("player.next"))+": "+e._s(e.suggestion.name_fa))]),e._v(" "),t("img",{directives:[{name:"lazy-load",rawName:"v-lazy-load"}],attrs:{"data-src":e.suggestionBackdrop,alt:"Next Movie Backdrop"}})])]):e._e()])},[],!1,null,"a90521c8",null);t.default=i.exports;installComponents(i,{VideoPlayer:a(750).default})},873:function(e,t,a){e.exports={}}}]);