(window.webpackJsonp=window.webpackJsonp||[]).push([[113],{1007:function(e,t,s){"use strict";s(870)},1074:function(e,t,s){"use strict";s.r(t);s(15),s(45),s(13);var a=s(27),i=(s(64),s(73),s(43),s(22),s(62),s(101),{components:{VideoPlayer:s(750).default},beforeRouteLeave:function(e,t,s){if(this.$swal&&this.$swal.close)try{this.$swal.close()}catch(e){}s()},layout:"empty",data:function(){return{episodeTitle:"",posterUrl:"",videoUrl:"",vastUrl:"",creditsData:{},tracks:[],loading:!0,soon:!1,guest:!0,series_id:0,show_report:!1,report_problem_type:null,report_details:"",report_button:!1,reportOptions:[{value:1,label:"report.labeling_problem"},{value:2,label:"report.video_problem"},{value:3,label:"report.sound_problem"},{value:4,label:"report.caption_problem"}],suggestion:null,suggestionBackdrop:"",showNextEpisode:!1,recentlyTime:200,showPlaylistMenu:!1,season:null,seasonList:[],seasonOpened:null,startTime:0,fullrateData:null}},computed:{currentEpisodeList:function(){return this.season&&this.season[this.seasonOpened]?this.season[this.seasonOpened]:[]}},watch:{showPlaylistMenu:function(e){document.body.style.overflow=e?"hidden":""}},mounted:function(){window.innerWidth<=767.98&&(document.documentElement.classList.add("video-page-mobile"),document.body.classList.add("video-page-mobile")),this.$auth&&this.$auth.loggedIn&&(this.guest=!1),this.loadEpisode(),window.addEventListener("popstate",this.handlePopState)},beforeDestroy:function(){if(document.documentElement.classList.remove("video-page-mobile"),document.body.classList.remove("video-page-mobile"),this.$swal&&this.$swal.close)try{this.$swal.close()}catch(e){}window.removeEventListener("popstate",this.handlePopState)},methods:{handlePopState:function(){if(this.$swal&&this.$swal.close)try{this.$swal.close()}catch(e){}},showErrorAlert:function(e){var t=this,s="fa"===this.$i18n.locale?e.message_fa:e.message;s||(s=this.$t("player.error1"));var a={back:{text:this.$t("player.back"),value:"back",closeModal:!0,className:"swal-back"}};1===e.show_download&&(a.download={text:this.$t("player.download"),value:"download",closeModal:!0}),1===e.show_ekran&&(a.download={text:this.$t("show.buy_ticket"),value:"download",closeModal:!0}),1===e.show_subscription&&(a.subscribe={text:this.$t("player.subscribe"),value:"subscribe",closeModal:!0}),this.$auth.loggedIn||1!==e.show_login||Object.assign(a,{login:{text:this.$t("nav.login"),value:"login",closeModal:!0}}),this.$swal({title:s,icon:"error",dangerMode:!0,buttons:a}).then(function(e){switch(e){case"back":default:window.history.length>2?t.$router.go(-1):t.$router.push({name:"episode-id",params:{id:t.$route.params.id}});break;case"subscribe":t.$store.dispatch("subscription/SHOW_MODAL",{content_type:"episode",content_id:t.$route.params.id});break;case"download":t.$router.push({name:"episode-payment-id",params:{id:t.$route.params.id},query:{force_to_buy:1}});break;case"login":t.$store.dispatch("login/SHOW_MODAL",{premessage:null,premobile:null,preredirect:null,prerefresh:!1})}})},loadEpisode:function(){var e=this;return Object(a.a)(regeneratorRuntime.mark(function t(){var s,a,i,o,r,n,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,s=e.$route.params.id){t.next=1;break}return t.abrupt("return");case 1:return a=e.$cookiz.get("ref")||"",i=e.guest?"/ghost/get/watch/series":"/get/watch/series",t.next=2,e.$axios.post(i,{episode_id:s,type:"sp",series_id:"",hls:1,ref:a});case 2:"success"===(o=t.sent).data.status?((r=o.data.data).fullrate_data&&(e.fullrateData=r.fullrate_data),n=r.episode[0],e.episodeTitle="fa"===e.$i18n.locale&&n.name_fa?n.name_fa:n.name,e.posterUrl=r.cdn.lg_backdrop+n.backdrop,e.videoUrl=n.video.includes("?")?n.video+"&nosub=1":n.video+"?nosub=1",e.vastUrl=r.vast,e.startTime=n.current_time||0,e.series_id=n.series_id||0,r.new_subtitle&&Array.isArray(r.new_subtitle)&&(e.tracks=r.new_subtitle.map(function(e,t){return{kind:"captions",label:e.language,src:e.url,default:0===t,language:e.language}})),e.creditsData={first_credits:r.first_credits||null,after_credits:r.after_credits||null,final_credits:r.final_credits||null},r.suggestion&&(e.suggestion=r.suggestion,e.suggestionBackdrop=r.cdn.md_backdrop+r.suggestion.backdrop),r.season&&Object.keys(r.season).length&&(e.season=r.season,e.seasonList=Object.keys(r.season),e.seasonOpened=n.season_number.toString()),e.soon=!1):e.showErrorAlert(o.data.data),t.next=4;break;case 3:t.prev=3,l=t.catch(0),e.showErrorAlert(l.response.data);case 4:return t.prev=4,e.loading=!1,t.finish(4);case 5:case"end":return t.stop()}},t,null,[[0,3,4,5]])}))()},togglePlaylistMenu:function(){this.showPlaylistMenu=!this.showPlaylistMenu},handlePlayerReady:function(e){this.startTime&&e.currentTime&&e.currentTime(this.startTime)},handleTimeUpdate:function(e){var t=e.currentTime,s=e.duration,a=e.player;if(Math.floor(t)>=this.recentlyTime){this.recentlyTime=Math.floor(t)+200;var i={current_time:Math.floor(t),duration_time:Math.floor(s),episode_id:this.$route.params.id,series_id:this.series_id};this.guest?this.$axios.post("/ghost/create/watch/series/recently",i):this.$axios.post("/create/watch/series/recently",i)}return this.creditsData.final_credits&&t>=this.creditsData.final_credits&&this.suggestion||!this.creditsData.final_credits&&s-t<=100&&this.suggestion?this.showNextMovie=!0:this.showNextMovie=!1,a},handleEnded:function(){this.suggestion&&this.playNextEpisode()},playNextEpisode:function(){this.$router.push({name:"episode-show-id",params:{id:this.suggestion.id}})},playEpisode:function(e){this.$router.push({name:"episode-show-id",params:{id:e}})},setSeason:function(e){this.seasonOpened=e},onSeasonChange:function(){},selectEpisode:function(e){this.togglePlaylistMenu(),this.$router.push({name:"episode-show-id",params:{id:e}})},goBack:function(){window.history.length>2?this.$router.go(-1):this.$router.push({name:"episode-id",params:{id:this.$route.params.id}})},handleSubscriptionPurchase:function(){},reloadPage:function(){location.reload()},openReport:function(){var e;this.show_report=!0;var t=null===(e=this.$refs.episodePlayer)||void 0===e?void 0:e.player;t&&t.pause()},closeReport:function(){var e;this.show_report=!1;var t=null===(e=this.$refs.episodePlayer)||void 0===e?void 0:e.player;t&&t.play(),this.$store.commit("player/CLOSE_REPORT")},sendReport:function(){var e=this;return Object(a.a)(regeneratorRuntime.mark(function t(){var s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.report_button=!0,t.prev=1,s={type:e.report_problem_type,details:e.report_details,id:e.$route.params.id},t.next=2,e.$axios.post("/create/report/episode",s);case 2:"success"===t.sent.data.status&&(e.report_button=!1,e.closeReport(),e.$alertify.logPosition("top right"),e.$alertify.success("Successful Send, our team will check it soon")),t.next=4;break;case 3:t.prev=3,t.catch(1),e.report_button=!1;case 4:case"end":return t.stop()}},t,null,[[1,3]])}))()},closePlaylistMenu:function(){this.showPlaylistMenu=!1}}}),o=(s(1007),s(32)),r=Object(o.a)(i,function(){var e=this,t=e._self._c;return t("div",{staticClass:"video-container"},[t("div",{staticClass:"hamshahri"},[t("div",{staticClass:"site-logo"},[t("img",{directives:[{name:"lazy-load",rawName:"v-lazy-load"},{name:"lazy",rawName:"v-lazy",value:s(469),expression:"require('@/assets/images/logo-mobile.svg')"}],attrs:{"data-src":s(469),alt:"Logo",loading:"lazy"}})]),e._v(" "),t("button",{staticClass:"back-button",on:{click:e.goBack}},[t("p",{staticClass:"back-text"},[e._v("بازگشت")]),e._v(" "),t("i",{staticClass:"fa fa-chevron-left",staticStyle:{color:"white"}})]),e._v(" "),e.loading?t("div",{staticClass:"video-loading-spinner"}):e._e(),e._v(" "),e.soon?t("p",{staticClass:"soon"},[e._v("به زودی...")]):e._e(),e._v(" "),e.soon?t("button",{staticClass:"btn btn-primary btn-lg fw-bold refresh-btn",on:{click:e.reloadPage}},[e._v("\n      بارگذاری مجدد\n    ")]):e._e()]),e._v(" "),t("div",{staticClass:"player-wrapper"},[e.videoUrl&&!e.loading?t("VideoPlayer",{directives:[{name:"lazy-load",rawName:"v-lazy-load"}],ref:"episodePlayer",staticClass:"full-screen-player vjs-fluid",attrs:{playerid:"episode-player",stream:e.videoUrl,"data-poster":e.posterUrl,title:e.episodeTitle,"vast-url":e.vastUrl||"",tracks:e.tracks,"player-auto-play":!0,"has-playlist":!!(e.seasonList&&e.seasonList.length||e.currentEpisodeList&&e.currentEpisodeList.length),"credits-data":e.creditsData,"fullrate-data":e.fullrateData,"content-id":e.$route.params.id,"content-type":"series"},on:{ready:e.handlePlayerReady,timeupdate:e.handleTimeUpdate,ended:e.handleEnded,playlistButtonClick:e.togglePlaylistMenu,"subscription-purchase":e.handleSubscriptionPurchase}}):e._e()],1),e._v(" "),e.showPlaylistMenu?t("div",{staticClass:"playlist-modal",on:{click:function(t){return t.target!==t.currentTarget?null:e.closePlaylistMenu.apply(null,arguments)}}},[t("div",{staticClass:"playlist-modal-content"},[t("div",{staticClass:"playlist-modal-header"},[t("button",{staticClass:"close-btn",on:{click:e.togglePlaylistMenu}},[t("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[t("path",{attrs:{d:"M18 6L6 18M6 6L18 18",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}})])]),e._v(" "),t("span",{staticClass:"modal-title"},[e._v("انتخاب فصل و قسمت")])]),e._v(" "),t("div",{staticClass:"divider"}),e._v(" "),t("div",{staticClass:"season-selector"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.seasonOpened,expression:"seasonOpened"}],staticClass:"season-dropdown",on:{change:[function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.seasonOpened=t.target.multiple?s:s[0]},e.onSeasonChange]}},e._l(e.seasonList,function(s){return t("option",{key:s,domProps:{value:s}},[e._v("\n            فصل "+e._s(s)+"\n          ")])}),0)]),e._v(" "),t("div",{staticClass:"episode-list"},e._l(e.currentEpisodeList,function(s){return t("div",{key:s.id,staticClass:"episode-card",on:{click:function(t){return e.selectEpisode(s.id)}}},[t("img",{directives:[{name:"lazy-load",rawName:"v-lazy-load"}],staticClass:"episode-image",attrs:{"data-src":s.still_path||e.posterUrl,alt:"قسمت ".concat(s.episode_number)}}),e._v(" "),t("div",{staticClass:"episode-info"},[t("div",{staticClass:"episode-title"},[t("span",[e._v("فصل "+e._s(s.season_number))]),e._v(" "),t("span",{staticClass:"separator"},[e._v("•")]),e._v(" "),t("span",[e._v("قسمت "+e._s(s.episode_number))])])])])}),0)])]):e._e(),e._v(" "),e.showNextEpisode&&e.suggestion?t("div",{staticClass:"next-episode-overlay",on:{click:e.playNextEpisode}},[t("div",{staticClass:"next-episode-content"},[t("p",[e._v(e._s(e.$t("player.play_next_episode"))+": "+e._s(e.suggestion.name_fa))]),e._v(" "),t("img",{directives:[{name:"lazy-load",rawName:"v-lazy-load"}],attrs:{"data-src":e.suggestionBackdrop,alt:"Next Episode Backdrop"}})])]):e._e()])},[],!1,null,"47e979a6",null);t.default=r.exports;installComponents(r,{VideoPlayer:s(750).default})},870:function(e,t,s){e.exports={}}}]);